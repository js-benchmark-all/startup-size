var e=Object.create;var t=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var r=Object.getOwnPropertyNames;var i=Object.getPrototypeOf;var a=Object.prototype.hasOwnProperty;var o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var s=(e,i,o,s)=>{if(i&&typeof i===`object`||typeof i===`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++){d=c[l];if(!a.call(e,d)&&d!==o)t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable})}return e};var c=(n,r,a)=>(a=n!=null?e(i(n)):{},s(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:true}):a,n));var l=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.regexpCode=exports.getEsmExportName=exports.getProperty=exports.safeStringify=exports.stringify=exports.strConcat=exports.addCodeArg=exports.str=exports._=exports.nil=exports._Code=exports.Name=exports.IDENTIFIER=exports._CodeOrName=void 0;var t=class{};exports._CodeOrName=t;exports.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var n=class extends t{constructor(t){super();if(!exports.IDENTIFIER.test(t))throw new Error(`CodeGen: name must be a valid identifier`);this.str=t}toString(){return this.str}emptyStr(){return false}get names(){return{[this.str]:1}}};exports.Name=n;var r=class extends t{constructor(e){super();this._items=typeof e===`string`?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return false;const e=this._items[0];return e===``||e===`""`}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,``)}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((e,t)=>{if(t instanceof n)e[t.str]=(e[t.str]||0)+1;return e},{})}};exports._Code=r;exports.nil=new r(``);function i(e,...t){const n=[e[0]];let i=0;while(i<t.length){s(n,t[i]);n.push(e[++i])}return new r(n)}exports._=i;const a=new r(`+`);function o(e,...t){const n=[p(e[0])];let i=0;while(i<t.length){n.push(a);s(n,t[i]);n.push(a,p(e[++i]))}c(n);return new r(n)}exports.str=o;function s(e,t){if(t instanceof r)e.push(...t._items);else if(t instanceof n)e.push(t);else e.push(d(t))}exports.addCodeArg=s;function c(e){let t=1;while(t<e.length-1){if(e[t]===a){const n=l(e[t-1],e[t+1]);if(n!==void 0){e.splice(t-1,3,n);continue}e[t++]=`+`}t++}}function l(e,t){if(t===`""`)return e;if(e===`""`)return t;if(typeof e==`string`){if(t instanceof n||e[e.length-1]!==`"`)return;if(typeof t!=`string`)return`${e.slice(0,-1)}${t}"`;if(t[0]===`"`)return e.slice(0,-1)+t.slice(1);return}if(typeof t==`string`&&t[0]===`"`&&!(e instanceof n))return`"${e}${t.slice(1)}`;return}function u(e,t){return t.emptyStr()?e:e.emptyStr()?t:o`${e}${t}`}exports.strConcat=u;function d(e){return typeof e==`number`||typeof e==`boolean`||e===null?e:p(Array.isArray(e)?e.join(`,`):e)}function f(e){return new r(p(e))}exports.stringify=f;function p(e){return JSON.stringify(e).replace(/\u2028/g,`\\u2028`).replace(/\u2029/g,`\\u2029`)}exports.safeStringify=p;function m(t){return typeof t==`string`&&exports.IDENTIFIER.test(t)?new r(`.${t}`):i`[${t}]`}exports.getProperty=m;function h(t){if(typeof t==`string`&&exports.IDENTIFIER.test(t))return new r(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}exports.getEsmExportName=h;function g(e){return new r(e.toString())}exports.regexpCode=g});var u=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.ValueScope=exports.ValueScopeName=exports.Scope=exports.varKinds=exports.UsedValueState=void 0;const t=l();var n=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`);this.value=e.value}};var r;(function(e){e[e[`Started`]=0]=`Started`;e[e[`Completed`]=1]=`Completed`})(r||(exports.UsedValueState=r={}));exports.varKinds={const:new t.Name(`const`),let:new t.Name(`let`),var:new t.Name(`var`)};var i=class{constructor({prefixes:e,parent:t}={}){this._names={};this._prefixes=e;this._parent=t}toName(e){return e instanceof t.Name?e:this.name(e)}name(e){return new t.Name(this._newName(e))}_newName(e){const t=this._names[e]||this._nameGroup(e);return`${e}${t.index++}`}_nameGroup(e){var t,n;if(((n=(t=this._parent)===null||t===void 0?void 0:t._prefixes)===null||n===void 0?void 0:n.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};exports.Scope=i;var a=class extends t.Name{constructor(e,t){super(t);this.prefix=e}setValue(e,{property:n,itemIndex:r}){this.value=e;this.scopePath=(0,t._)`.${new t.Name(n)}[${r}]`}};exports.ValueScopeName=a;const o=(0,t._)`\n`;var s=class extends i{constructor(e){super(e);this._values={};this._scope=e.scope;this.opts={...e,_n:e.lines?o:t.nil}}get(){return this._scope}name(e){return new a(e,this._newName(e))}value(e,t){var n;if(t.ref===void 0)throw new Error(`CodeGen: ref must be passed in value`);const r=this.toName(e);const{prefix:i}=r;const a=(n=t.key)!==null&&n!==void 0?n:t.ref;let o=this._values[i];if(o){const e=o.get(a);if(e)return e}else o=this._values[i]=new Map;o.set(a,r);const s=this._scope[i]||(this._scope[i]=[]);const c=s.length;s[c]=t.ref;r.setValue(t,{property:i,itemIndex:c});return r}getValue(e,t){const n=this._values[e];if(!n)return;return n.get(t)}scopeRefs(e,n=this._values){return this._reduceValues(n,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,t._)`${e}${n.scopePath}`})}scopeCode(e=this._values,t,n){return this._reduceValues(e,e=>{if(e.value===void 0)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,n)}_reduceValues(i,a,o={},s){let c=t.nil;for(const l in i){const u=i[l];if(!u)continue;const d=o[l]=o[l]||new Map;u.forEach(i=>{if(d.has(i))return;d.set(i,r.Started);let o=a(i);if(o){const n=this.opts.es5?exports.varKinds.var:exports.varKinds.const;c=(0,t._)`${c}${n} ${i} = ${o};${this.opts._n}`}else if(o=s===null||s===void 0?void 0:s(i))c=(0,t._)`${c}${o}${this.opts._n}`;else throw new n(i);d.set(i,r.Completed)})}return c}};exports.ValueScope=s});var d=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.or=exports.and=exports.not=exports.CodeGen=exports.operators=exports.varKinds=exports.ValueScopeName=exports.ValueScope=exports.Scope=exports.Name=exports.regexpCode=exports.stringify=exports.getProperty=exports.nil=exports.strConcat=exports.str=exports._=void 0;const t=l();const n=u();var r=l();Object.defineProperty(exports,`_`,{enumerable:true,get:function(){return r._}});Object.defineProperty(exports,`str`,{enumerable:true,get:function(){return r.str}});Object.defineProperty(exports,`strConcat`,{enumerable:true,get:function(){return r.strConcat}});Object.defineProperty(exports,`nil`,{enumerable:true,get:function(){return r.nil}});Object.defineProperty(exports,`getProperty`,{enumerable:true,get:function(){return r.getProperty}});Object.defineProperty(exports,`stringify`,{enumerable:true,get:function(){return r.stringify}});Object.defineProperty(exports,`regexpCode`,{enumerable:true,get:function(){return r.regexpCode}});Object.defineProperty(exports,`Name`,{enumerable:true,get:function(){return r.Name}});var i=u();Object.defineProperty(exports,`Scope`,{enumerable:true,get:function(){return i.Scope}});Object.defineProperty(exports,`ValueScope`,{enumerable:true,get:function(){return i.ValueScope}});Object.defineProperty(exports,`ValueScopeName`,{enumerable:true,get:function(){return i.ValueScopeName}});Object.defineProperty(exports,`varKinds`,{enumerable:true,get:function(){return i.varKinds}});exports.operators={GT:new t._Code(`>`),GTE:new t._Code(`>=`),LT:new t._Code(`<`),LTE:new t._Code(`<=`),EQ:new t._Code(`===`),NEQ:new t._Code(`!==`),NOT:new t._Code(`!`),OR:new t._Code(`||`),AND:new t._Code(`&&`),ADD:new t._Code(`+`)};var a=class{optimizeNodes(){return this}optimizeNames(e,t){return this}};var o=class extends a{constructor(e,t,n){super();this.varKind=e;this.name=t;this.rhs=n}render({es5:e,_n:t}){const r=e?n.varKinds.var:this.varKind;const i=this.rhs===void 0?``:` = ${this.rhs}`;return`${r} ${this.name}${i};`+t}optimizeNames(e,t){if(!e[this.name.str])return;if(this.rhs)this.rhs=M(this.rhs,e,t);return this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}};var s=class extends a{constructor(e,t,n){super();this.lhs=e;this.rhs=t;this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,n){if(this.lhs instanceof t.Name&&!e[this.lhs.str]&&!this.sideEffects)return;this.rhs=M(this.rhs,e,n);return this}get names(){const e=this.lhs instanceof t.Name?{}:{...this.lhs.names};return j(e,this.rhs)}};var c=class extends s{constructor(e,t,n,r){super(e,n,r);this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}};var d=class extends a{constructor(e){super();this.label=e;this.names={}}render({_n:e}){return`${this.label}:`+e}};var f=class extends a{constructor(e){super();this.label=e;this.names={}}render({_n:e}){const t=this.label?` ${this.label}`:``;return`break${t};`+e}};var p=class extends a{constructor(e){super();this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}};var m=class extends a{constructor(e){super();this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){this.code=M(this.code,e,t);return this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}};var h=class extends a{constructor(e=[]){super();this.nodes=e}render(e){return this.nodes.reduce((t,n)=>t+n.render(e),``)}optimizeNodes(){const{nodes:e}=this;let t=e.length;while(t--){const n=e[t].optimizeNodes();if(Array.isArray(n))e.splice(t,1,...n);else if(n)e[t]=n;else e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:n}=this;let r=n.length;while(r--){const i=n[r];if(i.optimizeNames(e,t))continue;N(e,i.names);n.splice(r,1)}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>A(e,t.names),{})}};var g=class extends h{render(e){return`{`+e._n+super.render(e)+`}`+e._n}};var _=class extends h{};var v=class extends g{};v.kind=`else`;var y=class e extends g{constructor(e,t){super(t);this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);if(this.else)t+=`else `+this.else.render(e);return t}optimizeNodes(){super.optimizeNodes();const t=this.condition;if(t===true)return this.nodes;let n=this.else;if(n){const e=n.optimizeNodes();n=this.else=Array.isArray(e)?new v(e):e}if(n){if(t===false)return n instanceof e?n:n.nodes;if(this.nodes.length)return this;return new e(P(t),n instanceof e?[n]:n.nodes)}if(t===false||!this.nodes.length)return void 0;return this}optimizeNames(e,t){var n;this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,t);if(!(super.optimizeNames(e,t)||this.else))return;this.condition=M(this.condition,e,t);return this}get names(){const e=super.names;j(e,this.condition);if(this.else)A(e,this.else.names);return e}};y.kind=`if`;var b=class extends g{};b.kind=`for`;var x=class extends b{constructor(e){super();this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(!super.optimizeNames(e,t))return;this.iteration=M(this.iteration,e,t);return this}get names(){return A(super.names,this.iteration.names)}};var S=class extends b{constructor(e,t,n,r){super();this.varKind=e;this.name=t;this.from=n;this.to=r}render(e){const t=e.es5?n.varKinds.var:this.varKind;const{name:r,from:i,to:a}=this;return`for(${t} ${r}=${i}; ${r}<${a}; ${r}++)`+super.render(e)}get names(){const e=j(super.names,this.from);return j(e,this.to)}};var C=class extends b{constructor(e,t,n,r){super();this.loop=e;this.varKind=t;this.name=n;this.iterable=r}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(!super.optimizeNames(e,t))return;this.iterable=M(this.iterable,e,t);return this}get names(){return A(super.names,this.iterable.names)}};var w=class extends g{constructor(e,t,n){super();this.name=e;this.args=t;this.async=n}render(e){const t=this.async?`async `:``;return`${t}function ${this.name}(${this.args})`+super.render(e)}};w.kind=`func`;var T=class extends h{render(e){return`return `+super.render(e)}};T.kind=`return`;var E=class extends g{render(e){let t=`try`+super.render(e);if(this.catch)t+=this.catch.render(e);if(this.finally)t+=this.finally.render(e);return t}optimizeNodes(){var e,t;super.optimizeNodes();(e=this.catch)===null||e===void 0||e.optimizeNodes();(t=this.finally)===null||t===void 0||t.optimizeNodes();return this}optimizeNames(e,t){var n,r;super.optimizeNames(e,t);(n=this.catch)===null||n===void 0||n.optimizeNames(e,t);(r=this.finally)===null||r===void 0||r.optimizeNames(e,t);return this}get names(){const e=super.names;if(this.catch)A(e,this.catch.names);if(this.finally)A(e,this.finally.names);return e}};var D=class extends g{constructor(e){super();this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};D.kind=`catch`;var O=class extends g{render(e){return`finally`+super.render(e)}};O.kind=`finally`;var k=class{constructor(e,t={}){this._values={};this._blockStarts=[];this._constants={};this.opts={...t,_n:t.lines?`
`:``};this._extScope=e;this._scope=new n.Scope({parent:e});this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const n=this._extScope.value(e,t);const r=this._values[n.prefix]||(this._values[n.prefix]=new Set);r.add(n);return n}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,n,r){const i=this._scope.toName(t);if(n!==void 0&&r)this._constants[i.str]=n;this._leafNode(new o(e,i,n));return i}const(e,t,r){return this._def(n.varKinds.const,e,t,r)}let(e,t,r){return this._def(n.varKinds.let,e,t,r)}var(e,t,r){return this._def(n.varKinds.var,e,t,r)}assign(e,t,n){return this._leafNode(new s(e,t,n))}add(t,n){return this._leafNode(new c(t,exports.operators.ADD,n))}code(e){if(typeof e==`function`)e();else if(e!==t.nil)this._leafNode(new m(e));return this}object(...e){const n=[`{`];for(const[r,i]of e){if(n.length>1)n.push(`,`);n.push(r);if(r!==i||this.opts.es5){n.push(`:`);(0,t.addCodeArg)(n,i)}}n.push(`}`);return new t._Code(n)}if(e,t,n){this._blockNode(new y(e));if(t&&n)this.code(t).else().code(n).endIf();else if(t)this.code(t).endIf();else if(n)throw new Error(`CodeGen: "else" body without "then" body`);return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new v)}endIf(){return this._endBlockNode(y,v)}_for(e,t){this._blockNode(e);if(t)this.code(t).endFor();return this}for(e,t){return this._for(new x(e),t)}forRange(e,t,r,i,a=this.opts.es5?n.varKinds.var:n.varKinds.let){const o=this._scope.toName(e);return this._for(new S(a,o,t,r),()=>i(o))}forOf(e,r,i,a=n.varKinds.const){const o=this._scope.toName(e);if(this.opts.es5){const e=r instanceof t.Name?r:this.var(`_arr`,r);return this.forRange(`_i`,0,(0,t._)`${e}.length`,n=>{this.var(o,(0,t._)`${e}[${n}]`);i(o)})}return this._for(new C(`of`,a,o,r),()=>i(o))}forIn(e,r,i,a=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,t._)`Object.keys(${r})`,i);const o=this._scope.toName(e);return this._for(new C(`in`,a,o,r),()=>i(o))}endFor(){return this._endBlockNode(b)}label(e){return this._leafNode(new d(e))}break(e){return this._leafNode(new f(e))}return(e){const t=new T;this._blockNode(t);this.code(e);if(t.nodes.length!==1)throw new Error(`CodeGen: "return" should have one node`);return this._endBlockNode(T)}try(e,t,n){if(!t&&!n)throw new Error(`CodeGen: "try" without "catch" and "finally"`);const r=new E;this._blockNode(r);this.code(e);if(t){const e=this.name(`e`);this._currNode=r.catch=new D(e);t(e)}if(n){this._currNode=r.finally=new O;this.code(n)}return this._endBlockNode(D,O)}throw(e){return this._leafNode(new p(e))}block(e,t){this._blockStarts.push(this._nodes.length);if(e)this.code(e).endBlock(t);return this}endBlock(e){const t=this._blockStarts.pop();if(t===void 0)throw new Error(`CodeGen: not in self-balancing block`);const n=this._nodes.length-t;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);this._nodes.length=t;return this}func(e,n=t.nil,r,i){this._blockNode(new w(e,n,r));if(i)this.code(i).endFunc();return this}endFunc(){return this._endBlockNode(w)}optimize(e=1){while(e-- >0){this._root.optimizeNodes();this._root.optimizeNames(this._root.names,this._constants)}}_leafNode(e){this._currNode.nodes.push(e);return this}_blockNode(e){this._currNode.nodes.push(e);this._nodes.push(e)}_endBlockNode(e,t){const n=this._currNode;if(n instanceof e||t&&n instanceof t){this._nodes.pop();return this}throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof y))throw new Error(`CodeGen: "else" without "if"`);this._currNode=t.else=e;return this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}};exports.CodeGen=k;function A(e,t){for(const n in t)e[n]=(e[n]||0)+(t[n]||0);return e}function j(e,n){return n instanceof t._CodeOrName?A(e,n.names):e}function M(e,n,r){if(e instanceof t.Name)return i(e);if(!a(e))return e;return new t._Code(e._items.reduce((e,n)=>{if(n instanceof t.Name)n=i(n);if(n instanceof t._Code)e.push(...n._items);else e.push(n);return e},[]));function i(e){const t=r[e.str];if(t===void 0||n[e.str]!==1)return e;delete n[e.str];return t}function a(e){return e instanceof t._Code&&e._items.some(e=>e instanceof t.Name&&n[e.str]===1&&r[e.str]!==void 0)}}function N(e,t){for(const n in t)e[n]=(e[n]||0)-(t[n]||0)}function P(e){return typeof e==`boolean`||typeof e==`number`||e===null?!e:(0,t._)`!${B(e)}`}exports.not=P;const F=z(exports.operators.AND);function I(...e){return e.reduce(F)}exports.and=I;const L=z(exports.operators.OR);function R(...e){return e.reduce(L)}exports.or=R;function z(e){return(n,r)=>n===t.nil?r:r===t.nil?n:(0,t._)`${B(n)} ${e} ${B(r)}`}function B(e){return e instanceof t.Name?e:(0,t._)`(${e})`}});var f=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.checkStrictMode=exports.getErrorPath=exports.Type=exports.useFunc=exports.setEvaluated=exports.evaluatedPropsToName=exports.mergeEvaluated=exports.eachItem=exports.unescapeJsonPointer=exports.escapeJsonPointer=exports.escapeFragment=exports.unescapeFragment=exports.schemaRefOrVal=exports.schemaHasRulesButRef=exports.schemaHasRules=exports.checkUnknownRules=exports.alwaysValidSchema=exports.toHash=void 0;const t=d();const n=l();function r(e){const t={};for(const n of e)t[n]=true;return t}exports.toHash=r;function i(e,t){if(typeof t==`boolean`)return t;if(Object.keys(t).length===0)return true;a(e,t);return!o(t,e.self.RULES.all)}exports.alwaysValidSchema=i;function a(e,t=e.schema){const{opts:n,self:r}=e;if(!n.strictSchema)return;if(typeof t===`boolean`)return;const i=r.RULES.keywords;for(const n in t)if(!i[n])C(e,`unknown keyword: "${n}"`)}exports.checkUnknownRules=a;function o(e,t){if(typeof e==`boolean`)return!e;for(const n in e)if(t[n])return true;return false}exports.schemaHasRules=o;function s(e,t){if(typeof e==`boolean`)return!e;for(const n in e)if(n!==`$ref`&&t.all[n])return true;return false}exports.schemaHasRulesButRef=s;function c({topSchemaRef:e,schemaPath:n},r,i,a){if(!a){if(typeof r==`number`||typeof r==`boolean`)return r;if(typeof r==`string`)return(0,t._)`${r}`}return(0,t._)`${e}${n}${(0,t.getProperty)(i)}`}exports.schemaRefOrVal=c;function u(e){return m(decodeURIComponent(e))}exports.unescapeFragment=u;function f(e){return encodeURIComponent(p(e))}exports.escapeFragment=f;function p(e){if(typeof e==`number`)return`${e}`;return e.replace(/~/g,`~0`).replace(/\//g,`~1`)}exports.escapeJsonPointer=p;function m(e){return e.replace(/~1/g,`/`).replace(/~0/g,`~`)}exports.unescapeJsonPointer=m;function h(e,t){if(Array.isArray(e))for(const n of e)t(n);else t(e)}exports.eachItem=h;function g({mergeNames:e,mergeToName:n,mergeValues:r,resultToName:i}){return(a,o,s,c)=>{const l=s===void 0?o:s instanceof t.Name?(o instanceof t.Name?e(a,o,s):n(a,o,s),s):o instanceof t.Name?(n(a,s,o),o):r(o,s);return c===t.Name&&!(l instanceof t.Name)?i(a,l):l}}exports.mergeEvaluated={props:g({mergeNames:(e,n,r)=>e.if((0,t._)`${r} !== true && ${n} !== undefined`,()=>{e.if((0,t._)`${n} === true`,()=>e.assign(r,true),()=>e.assign(r,(0,t._)`${r} || {}`).code((0,t._)`Object.assign(${r}, ${n})`))}),mergeToName:(e,n,r)=>e.if((0,t._)`${r} !== true`,()=>{if(n===true)e.assign(r,true);else{e.assign(r,(0,t._)`${r} || {}`);v(e,r,n)}}),mergeValues:(e,t)=>e===true?true:{...e,...t},resultToName:_}),items:g({mergeNames:(e,n,r)=>e.if((0,t._)`${r} !== true && ${n} !== undefined`,()=>e.assign(r,(0,t._)`${n} === true ? true : ${r} > ${n} ? ${r} : ${n}`)),mergeToName:(e,n,r)=>e.if((0,t._)`${r} !== true`,()=>e.assign(r,n===true?true:(0,t._)`${r} > ${n} ? ${r} : ${n}`)),mergeValues:(e,t)=>e===true?true:Math.max(e,t),resultToName:(e,t)=>e.var(`items`,t)})};function _(e,n){if(n===true)return e.var(`props`,true);const r=e.var(`props`,(0,t._)`{}`);if(n!==void 0)v(e,r,n);return r}exports.evaluatedPropsToName=_;function v(e,n,r){Object.keys(r).forEach(r=>e.assign((0,t._)`${n}${(0,t.getProperty)(r)}`,true))}exports.setEvaluated=v;const y={};function b(e,t){return e.scopeValue(`func`,{ref:t,code:y[t.code]||(y[t.code]=new n._Code(t.code))})}exports.useFunc=b;var x;(function(e){e[e[`Num`]=0]=`Num`;e[e[`Str`]=1]=`Str`})(x||(exports.Type=x={}));function S(e,n,r){if(e instanceof t.Name){const i=n===x.Num;return r?i?(0,t._)`"[" + ${e} + "]"`:(0,t._)`"['" + ${e} + "']"`:i?(0,t._)`"/" + ${e}`:(0,t._)`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,t.getProperty)(e).toString():`/`+p(e)}exports.getErrorPath=S;function C(e,t,n=e.opts.strictSchema){if(!n)return;t=`strict mode: ${t}`;if(n===true)throw new Error(t);e.self.logger.warn(t)}exports.checkStrictMode=C});var p=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=d();const n={data:new t.Name(`data`),valCxt:new t.Name(`valCxt`),instancePath:new t.Name(`instancePath`),parentData:new t.Name(`parentData`),parentDataProperty:new t.Name(`parentDataProperty`),rootData:new t.Name(`rootData`),dynamicAnchors:new t.Name(`dynamicAnchors`),vErrors:new t.Name(`vErrors`),errors:new t.Name(`errors`),this:new t.Name(`this`),self:new t.Name(`self`),scope:new t.Name(`scope`),json:new t.Name(`json`),jsonPos:new t.Name(`jsonPos`),jsonLen:new t.Name(`jsonLen`),jsonPart:new t.Name(`jsonPart`)};exports.default=n});var m=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.extendErrors=exports.resetErrorsCount=exports.reportExtraError=exports.reportError=exports.keyword$DataError=exports.keywordError=void 0;const t=d();const n=f();const r=p();exports.keywordError={message:({keyword:e})=>(0,t.str)`must pass "${e}" keyword validation`};exports.keyword$DataError={message:({keyword:e,schemaType:n})=>n?(0,t.str)`"${e}" keyword must be ${n} ($data)`:(0,t.str)`"${e}" keyword is invalid ($data)`};function i(n,r=exports.keywordError,i,a){const{it:o}=n;const{gen:s,compositeRule:u,allErrors:d}=o;const f=m(n,r,i);if(a!==null&&a!==void 0?a:u||d)c(s,f);else l(o,(0,t._)`[${f}]`)}exports.reportError=i;function a(t,n=exports.keywordError,i){const{it:a}=t;const{gen:o,compositeRule:s,allErrors:u}=a;const d=m(t,n,i);c(o,d);if(!(s||u))l(a,r.default.vErrors)}exports.reportExtraError=a;function o(e,n){e.assign(r.default.errors,n);e.if((0,t._)`${r.default.vErrors} !== null`,()=>e.if(n,()=>e.assign((0,t._)`${r.default.vErrors}.length`,n),()=>e.assign(r.default.vErrors,null)))}exports.resetErrorsCount=o;function s({gen:e,keyword:n,schemaValue:i,data:a,errsCount:o,it:s}){if(o===void 0)throw new Error(`ajv implementation error`);const c=e.name(`err`);e.forRange(`i`,o,r.default.errors,o=>{e.const(c,(0,t._)`${r.default.vErrors}[${o}]`);e.if((0,t._)`${c}.instancePath === undefined`,()=>e.assign((0,t._)`${c}.instancePath`,(0,t.strConcat)(r.default.instancePath,s.errorPath)));e.assign((0,t._)`${c}.schemaPath`,(0,t.str)`${s.errSchemaPath}/${n}`);if(s.opts.verbose){e.assign((0,t._)`${c}.schema`,i);e.assign((0,t._)`${c}.data`,a)}})}exports.extendErrors=s;function c(e,n){const i=e.const(`err`,n);e.if((0,t._)`${r.default.vErrors} === null`,()=>e.assign(r.default.vErrors,(0,t._)`[${i}]`),(0,t._)`${r.default.vErrors}.push(${i})`);e.code((0,t._)`${r.default.errors}++`)}function l(e,n){const{gen:r,validateName:i,schemaEnv:a}=e;if(a.$async)r.throw((0,t._)`new ${e.ValidationError}(${n})`);else{r.assign((0,t._)`${i}.errors`,n);r.return(false)}}const u={keyword:new t.Name(`keyword`),schemaPath:new t.Name(`schemaPath`),params:new t.Name(`params`),propertyName:new t.Name(`propertyName`),message:new t.Name(`message`),schema:new t.Name(`schema`),parentSchema:new t.Name(`parentSchema`)};function m(e,n,r){const{createErrors:i}=e.it;if(i===false)return(0,t._)`{}`;return h(e,n,r)}function h(e,t,n={}){const{gen:r,it:i}=e;const a=[g(i,n),_(e,n)];v(e,t,a);return r.object(...a)}function g({errorPath:e},{instancePath:i}){const a=i?(0,t.str)`${e}${(0,n.getErrorPath)(i,n.Type.Str)}`:e;return[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,a)]}function _({keyword:e,it:{errSchemaPath:r}},{schemaPath:i,parentSchema:a}){let o=a?r:(0,t.str)`${r}/${e}`;if(i)o=(0,t.str)`${o}${(0,n.getErrorPath)(i,n.Type.Str)}`;return[u.schemaPath,o]}function v(e,{params:n,message:i},a){const{keyword:o,data:s,schemaValue:c,it:l}=e;const{opts:d,propertyName:f,topSchemaRef:p,schemaPath:m}=l;a.push([u.keyword,o],[u.params,typeof n==`function`?n(e):n||(0,t._)`{}`]);if(d.messages)a.push([u.message,typeof i==`function`?i(e):i]);if(d.verbose)a.push([u.schema,c],[u.parentSchema,(0,t._)`${p}${m}`],[r.default.data,s]);if(f)a.push([u.propertyName,f])}});var h=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.boolOrEmptySchema=exports.topBoolOrEmptySchema=void 0;const t=m();const n=d();const r=p();const i={message:`boolean schema is false`};function a(e){const{gen:t,schema:i,validateName:a}=e;if(i===false)s(e,false);else if(typeof i==`object`&&i.$async===true)t.return(r.default.data);else{t.assign((0,n._)`${a}.errors`,null);t.return(true)}}exports.topBoolOrEmptySchema=a;function o(e,t){const{gen:n,schema:r}=e;if(r===false){n.var(t,false);s(e)}else n.var(t,true)}exports.boolOrEmptySchema=o;function s(e,n){const{gen:r,data:a}=e;const o={gen:r,keyword:`false schema`,data:a,schema:false,schemaCode:false,schemaValue:false,params:{},it:e};(0,t.reportError)(o,i,void 0,n)}});var g=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.getRules=exports.isJSONType=void 0;const t=[`string`,`number`,`integer`,`boolean`,`null`,`object`,`array`];const n=new Set(t);function r(e){return typeof e==`string`&&n.has(e)}exports.isJSONType=r;function i(){const e={number:{type:`number`,rules:[]},string:{type:`string`,rules:[]},array:{type:`array`,rules:[]},object:{type:`object`,rules:[]}};return{types:{...e,integer:true,boolean:true,null:true},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}exports.getRules=i});var _=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.shouldUseRule=exports.shouldUseGroup=exports.schemaHasRulesForType=void 0;function t({schema:e,self:t},r){const i=t.RULES.types[r];return i&&i!==true&&n(e,i)}exports.schemaHasRulesForType=t;function n(e,t){return t.rules.some(t=>r(e,t))}exports.shouldUseGroup=n;function r(e,t){var n;return e[t.keyword]!==void 0||((n=t.definition.implements)===null||n===void 0?void 0:n.some(t=>e[t]!==void 0))}exports.shouldUseRule=r});var v=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.reportTypeError=exports.checkDataTypes=exports.checkDataType=exports.coerceAndCheckDataType=exports.getJSONTypes=exports.getSchemaTypes=exports.DataType=void 0;const t=g();const n=_();const r=m();const i=d();const a=f();var o;(function(e){e[e[`Correct`]=0]=`Correct`;e[e[`Wrong`]=1]=`Wrong`})(o||(exports.DataType=o={}));function s(e){const t=c(e.type);const n=t.includes(`null`);if(n){if(e.nullable===false)throw new Error(`type: null contradicts nullable: false`)}else{if(!t.length&&e.nullable!==void 0)throw new Error(`"nullable" cannot be used without "type"`);if(e.nullable===true)t.push(`null`)}return t}exports.getSchemaTypes=s;function c(e){const n=Array.isArray(e)?e:e?[e]:[];if(n.every(t.isJSONType))return n;throw new Error(`type must be JSONType or JSONType[]: `+n.join(`,`))}exports.getJSONTypes=c;function l(e,t){const{gen:r,data:i,opts:a}=e;const s=p(t,a.coerceTypes);const c=t.length>0&&!(s.length===0&&t.length===1&&(0,n.schemaHasRulesForType)(e,t[0]));if(c){const n=b(t,i,a.strictNumbers,o.Wrong);r.if(n,()=>{if(s.length)h(e,t,s);else S(e)})}return c}exports.coerceAndCheckDataType=l;const u=new Set([`string`,`number`,`integer`,`boolean`,`null`]);function p(e,t){return t?e.filter(e=>u.has(e)||t===`array`&&e===`array`):[]}function h(e,t,n){const{gen:r,data:a,opts:o}=e;const s=r.let(`dataType`,(0,i._)`typeof ${a}`);const c=r.let(`coerced`,(0,i._)`undefined`);if(o.coerceTypes===`array`)r.if((0,i._)`${s} == 'object' && Array.isArray(${a}) && ${a}.length == 1`,()=>r.assign(a,(0,i._)`${a}[0]`).assign(s,(0,i._)`typeof ${a}`).if(b(t,a,o.strictNumbers),()=>r.assign(c,a)));r.if((0,i._)`${c} !== undefined`);for(const e of n)if(u.has(e)||e===`array`&&o.coerceTypes===`array`)l(e);r.else();S(e);r.endIf();r.if((0,i._)`${c} !== undefined`,()=>{r.assign(a,c);v(e,c)});function l(e){switch(e){case`string`:r.elseIf((0,i._)`${s} == "number" || ${s} == "boolean"`).assign(c,(0,i._)`"" + ${a}`).elseIf((0,i._)`${a} === null`).assign(c,(0,i._)`""`);return;case`number`:r.elseIf((0,i._)`${s} == "boolean" || ${a} === null
              || (${s} == "string" && ${a} && ${a} == +${a})`).assign(c,(0,i._)`+${a}`);return;case`integer`:r.elseIf((0,i._)`${s} === "boolean" || ${a} === null
              || (${s} === "string" && ${a} && ${a} == +${a} && !(${a} % 1))`).assign(c,(0,i._)`+${a}`);return;case`boolean`:r.elseIf((0,i._)`${a} === "false" || ${a} === 0 || ${a} === null`).assign(c,false).elseIf((0,i._)`${a} === "true" || ${a} === 1`).assign(c,true);return;case`null`:r.elseIf((0,i._)`${a} === "" || ${a} === 0 || ${a} === false`);r.assign(c,null);return;case`array`:r.elseIf((0,i._)`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${a} === null`).assign(c,(0,i._)`[${a}]`)}}}function v({gen:e,parentData:t,parentDataProperty:n},r){e.if((0,i._)`${t} !== undefined`,()=>e.assign((0,i._)`${t}[${n}]`,r))}function y(e,t,n,r=o.Correct){const a=r===o.Correct?i.operators.EQ:i.operators.NEQ;let s;switch(e){case`null`:return(0,i._)`${t} ${a} null`;case`array`:s=(0,i._)`Array.isArray(${t})`;break;case`object`:s=(0,i._)`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case`integer`:s=c((0,i._)`!(${t} % 1) && !isNaN(${t})`);break;case`number`:s=c();break;default:return(0,i._)`typeof ${t} ${a} ${e}`}return r===o.Correct?s:(0,i.not)(s);function c(e=i.nil){return(0,i.and)((0,i._)`typeof ${t} == "number"`,e,n?(0,i._)`isFinite(${t})`:i.nil)}}exports.checkDataType=y;function b(e,t,n,r){if(e.length===1)return y(e[0],t,n,r);let o;const s=(0,a.toHash)(e);if(s.array&&s.object){const e=(0,i._)`typeof ${t} != "object"`;o=s.null?e:(0,i._)`!${t} || ${e}`;delete s.null;delete s.array;delete s.object}else o=i.nil;if(s.number)delete s.integer;for(const e in s)o=(0,i.and)(o,y(e,t,n,r));return o}exports.checkDataTypes=b;const x={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>typeof e==`string`?(0,i._)`{type: ${e}}`:(0,i._)`{type: ${t}}`};function S(e){const t=C(e);(0,r.reportError)(t,x)}exports.reportTypeError=S;function C(e){const{gen:t,data:n,schema:r}=e;const i=(0,a.schemaRefOrVal)(e,r,`type`);return{gen:t,keyword:`type`,data:n,schema:r.type,schemaCode:i,schemaValue:i,parentSchema:r,params:{},it:e}}});var y=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.assignDefaults=void 0;const t=d();const n=f();function r(e,t){const{properties:n,items:r}=e.schema;if(t===`object`&&n)for(const t in n)i(e,t,n[t].default);else if(t===`array`&&Array.isArray(r))r.forEach((t,n)=>i(e,n,t.default))}exports.assignDefaults=r;function i(e,r,i){const{gen:a,compositeRule:o,data:s,opts:c}=e;if(i===void 0)return;const l=(0,t._)`${s}${(0,t.getProperty)(r)}`;if(o){(0,n.checkStrictMode)(e,`default is ignored for: ${l}`);return}let u=(0,t._)`${l} === undefined`;if(c.useDefaults===`empty`)u=(0,t._)`${u} || ${l} === null || ${l} === ""`;a.if(u,(0,t._)`${l} = ${(0,t.stringify)(i)}`)}});var b=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.validateUnion=exports.validateArray=exports.usePattern=exports.callValidateCode=exports.schemaProperties=exports.allSchemaProperties=exports.noPropertyInData=exports.propertyInData=exports.isOwnProperty=exports.hasPropFunc=exports.reportMissingProp=exports.checkMissingProp=exports.checkReportMissingProp=void 0;const t=d();const n=f();const r=p();const i=f();function a(e,n){const{gen:r,data:i,it:a}=e;r.if(m(r,i,n,a.opts.ownProperties),()=>{e.setParams({missingProperty:(0,t._)`${n}`},true);e.error()})}exports.checkReportMissingProp=a;function o({gen:e,data:n,it:{opts:r}},i,a){return(0,t.or)(...i.map(i=>(0,t.and)(m(e,n,i,r.ownProperties),(0,t._)`${a} = ${i}`)))}exports.checkMissingProp=o;function s(e,t){e.setParams({missingProperty:t},true);e.error()}exports.reportMissingProp=s;function c(e){return e.scopeValue(`func`,{ref:Object.prototype.hasOwnProperty,code:(0,t._)`Object.prototype.hasOwnProperty`})}exports.hasPropFunc=c;function l(e,n,r){return(0,t._)`${c(e)}.call(${n}, ${r})`}exports.isOwnProperty=l;function u(e,n,r,i){const a=(0,t._)`${n}${(0,t.getProperty)(r)} !== undefined`;return i?(0,t._)`${a} && ${l(e,n,r)}`:a}exports.propertyInData=u;function m(e,n,r,i){const a=(0,t._)`${n}${(0,t.getProperty)(r)} === undefined`;return i?(0,t.or)(a,(0,t.not)(l(e,n,r))):a}exports.noPropertyInData=m;function h(e){return e?Object.keys(e).filter(e=>e!==`__proto__`):[]}exports.allSchemaProperties=h;function g(e,t){return h(t).filter(r=>!(0,n.alwaysValidSchema)(e,t[r]))}exports.schemaProperties=g;function _({schemaCode:e,data:n,it:{gen:i,topSchemaRef:a,schemaPath:o,errorPath:s},it:c},l,u,d){const f=d?(0,t._)`${e}, ${n}, ${a}${o}`:n;const p=[[r.default.instancePath,(0,t.strConcat)(r.default.instancePath,s)],[r.default.parentData,c.parentData],[r.default.parentDataProperty,c.parentDataProperty],[r.default.rootData,r.default.rootData]];if(c.opts.dynamicRef)p.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const m=(0,t._)`${f}, ${i.object(...p)}`;return u!==t.nil?(0,t._)`${l}.call(${u}, ${m})`:(0,t._)`${l}(${m})`}exports.callValidateCode=_;const v=(0,t._)`new RegExp`;function y({gen:e,it:{opts:n}},r){const a=n.unicodeRegExp?`u`:``;const{regExp:o}=n.code;const s=o(r,a);return e.scopeValue(`pattern`,{key:s.toString(),ref:s,code:(0,t._)`${o.code===`new RegExp`?v:(0,i.useFunc)(e,o)}(${r}, ${a})`})}exports.usePattern=y;function b(e){const{gen:r,data:i,keyword:a,it:o}=e;const s=r.name(`valid`);if(o.allErrors){const e=r.let(`valid`,true);c(()=>r.assign(e,false));return e}r.var(s,true);c(()=>r.break());return s;function c(o){const c=r.const(`len`,(0,t._)`${i}.length`);r.forRange(`i`,0,c,i=>{e.subschema({keyword:a,dataProp:i,dataPropType:n.Type.Num},s);r.if((0,t.not)(s),o)})}}exports.validateArray=b;function x(e){const{gen:r,schema:i,keyword:a,it:o}=e;if(!Array.isArray(i))throw new Error(`ajv implementation error`);const s=i.some(e=>(0,n.alwaysValidSchema)(o,e));if(s&&!o.opts.unevaluated)return;const c=r.let(`valid`,false);const l=r.name(`_valid`);r.block(()=>i.forEach((n,i)=>{const o=e.subschema({keyword:a,schemaProp:i,compositeRule:true},l);r.assign(c,(0,t._)`${c} || ${l}`);const s=e.mergeValidEvaluated(o,l);if(!s)r.if((0,t.not)(c))}));e.result(c,()=>e.reset(),()=>e.error(true))}exports.validateUnion=x});var x=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.validateKeywordUsage=exports.validSchemaType=exports.funcKeywordCode=exports.macroKeywordCode=void 0;const t=d();const n=p();const r=b();const i=m();function a(e,n){const{gen:r,keyword:i,schema:a,parentSchema:o,it:s}=e;const c=n.macro.call(s.self,a,o,s);const l=u(r,i,c);if(s.opts.validateSchema!==false)s.self.validateSchema(c,true);const d=r.name(`valid`);e.subschema({schema:c,schemaPath:t.nil,errSchemaPath:`${s.errSchemaPath}/${i}`,topSchemaRef:l,compositeRule:true},d);e.pass(d,()=>e.error(true))}exports.macroKeywordCode=a;function o(e,i){var a;const{gen:o,keyword:d,schema:f,parentSchema:p,$data:m,it:h}=e;l(h,i);const g=!m&&i.compile?i.compile.call(h.self,f,p,h):i.validate;const _=u(o,d,g);const v=o.let(`valid`);e.block$data(v,y);e.ok((a=i.valid)!==null&&a!==void 0?a:v);function y(){if(i.errors===false){S();if(i.modifying)s(e);C(()=>e.error())}else{const t=i.async?b():x();if(i.modifying)s(e);C(()=>c(e,t))}}function b(){const e=o.let(`ruleErrs`,null);o.try(()=>S((0,t._)`await `),n=>o.assign(v,false).if((0,t._)`${n} instanceof ${h.ValidationError}`,()=>o.assign(e,(0,t._)`${n}.errors`),()=>o.throw(n)));return e}function x(){const e=(0,t._)`${_}.errors`;o.assign(e,null);S(t.nil);return e}function S(a=i.async?(0,t._)`await `:t.nil){const s=h.opts.passContext?n.default.this:n.default.self;const c=!(`compile`in i&&!m||i.schema===false);o.assign(v,(0,t._)`${a}${(0,r.callValidateCode)(e,_,s,c)}`,i.modifying)}function C(e){var n;o.if((0,t.not)((n=i.valid)!==null&&n!==void 0?n:v),e)}}exports.funcKeywordCode=o;function s(e){const{gen:n,data:r,it:i}=e;n.if(i.parentData,()=>n.assign(r,(0,t._)`${i.parentData}[${i.parentDataProperty}]`))}function c(e,r){const{gen:a}=e;a.if((0,t._)`Array.isArray(${r})`,()=>{a.assign(n.default.vErrors,(0,t._)`${n.default.vErrors} === null ? ${r} : ${n.default.vErrors}.concat(${r})`).assign(n.default.errors,(0,t._)`${n.default.vErrors}.length`);(0,i.extendErrors)(e)},()=>e.error())}function l({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error(`async keyword in sync schema`)}function u(e,n,r){if(r===void 0)throw new Error(`keyword "${n}" failed to compile`);return e.scopeValue(`keyword`,typeof r==`function`?{ref:r}:{ref:r,code:(0,t.stringify)(r)})}function f(e,t,n=false){return!t.length||t.some(t=>t===`array`?Array.isArray(e):t===`object`?e&&typeof e==`object`&&!Array.isArray(e):typeof e==t||n&&typeof e==`undefined`)}exports.validSchemaType=f;function h({schema:e,opts:t,self:n,errSchemaPath:r},i,a){if(Array.isArray(i.keyword)?!i.keyword.includes(a):i.keyword!==a)throw new Error(`ajv implementation error`);const o=i.dependencies;if(o===null||o===void 0?void 0:o.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${a}: ${o.join(`,`)}`);if(i.validateSchema){const o=i.validateSchema(e[a]);if(!o){const e=`keyword "${a}" value is invalid at path "${r}": `+n.errorsText(i.validateSchema.errors);if(t.validateSchema===`log`)n.logger.error(e);else throw new Error(e)}}}exports.validateKeywordUsage=h});var S=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.extendSubschemaMode=exports.extendSubschemaData=exports.getSubschema=void 0;const t=d();const n=f();function r(e,{keyword:r,schemaProp:i,schema:a,schemaPath:o,errSchemaPath:s,topSchemaRef:c}){if(r!==void 0&&a!==void 0)throw new Error(`both "keyword" and "schema" passed, only one allowed`);if(r!==void 0){const a=e.schema[r];return i===void 0?{schema:a,schemaPath:(0,t._)`${e.schemaPath}${(0,t.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${r}`}:{schema:a[i],schemaPath:(0,t._)`${e.schemaPath}${(0,t.getProperty)(r)}${(0,t.getProperty)(i)}`,errSchemaPath:`${e.errSchemaPath}/${r}/${(0,n.escapeFragment)(i)}`}}if(a!==void 0){if(o===void 0||s===void 0||c===void 0)throw new Error(`"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"`);return{schema:a,schemaPath:o,topSchemaRef:c,errSchemaPath:s}}throw new Error(`either "keyword" or "schema" must be passed`)}exports.getSubschema=r;function i(e,r,{dataProp:i,dataPropType:a,data:o,dataTypes:s,propertyName:c}){if(o!==void 0&&i!==void 0)throw new Error(`both "data" and "dataProp" passed, only one allowed`);const{gen:l}=r;if(i!==void 0){const{errorPath:o,dataPathArr:s,opts:c}=r;const d=l.let(`data`,(0,t._)`${r.data}${(0,t.getProperty)(i)}`,true);u(d);e.errorPath=(0,t.str)`${o}${(0,n.getErrorPath)(i,a,c.jsPropertySyntax)}`;e.parentDataProperty=(0,t._)`${i}`;e.dataPathArr=[...s,e.parentDataProperty]}if(o!==void 0){const n=o instanceof t.Name?o:l.let(`data`,o,true);u(n);if(c!==void 0)e.propertyName=c}if(s)e.dataTypes=s;function u(t){e.data=t;e.dataLevel=r.dataLevel+1;e.dataTypes=[];r.definedProperties=new Set;e.parentData=r.data;e.dataNames=[...r.dataNames,t]}}exports.extendSubschemaData=i;function a(e,{jtdDiscriminator:t,jtdMetadata:n,compositeRule:r,createErrors:i,allErrors:a}){if(r!==void 0)e.compositeRule=r;if(i!==void 0)e.createErrors=i;if(a!==void 0)e.allErrors=a;e.jtdDiscriminator=t;e.jtdMetadata=n}exports.extendSubschemaMode=a});var C=o((exports,t)=>{t.exports=function e(t,n){if(t===n)return true;if(t&&n&&typeof t==`object`&&typeof n==`object`){if(t.constructor!==n.constructor)return false;var r,i,a;if(Array.isArray(t)){r=t.length;if(r!=n.length)return false;for(i=r;i--!==0;)if(!e(t[i],n[i]))return false;return true}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();a=Object.keys(t);r=a.length;if(r!==Object.keys(n).length)return false;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return false;for(i=r;i--!==0;){var o=a[i];if(!e(t[o],n[o]))return false}return true}return t!==t&&n!==n}});var w=o((exports,t)=>{var n=t.exports=function(e,t,n){if(typeof t==`function`){n=t;t={}}n=t.cb||n;var i=typeof n==`function`?n:n.pre||function(){};var a=n.post||function(){};r(t,i,a,e,``,e)};n.keywords={additionalItems:true,items:true,contains:true,additionalProperties:true,propertyNames:true,not:true,if:true,then:true,else:true};n.arrayKeywords={items:true,allOf:true,anyOf:true,oneOf:true};n.propsKeywords={$defs:true,definitions:true,properties:true,patternProperties:true,dependencies:true};n.skipKeywords={default:true,enum:true,const:true,required:true,maximum:true,minimum:true,exclusiveMaximum:true,exclusiveMinimum:true,multipleOf:true,maxLength:true,minLength:true,pattern:true,format:true,maxItems:true,minItems:true,uniqueItems:true,maxProperties:true,minProperties:true};function r(e,t,a,o,s,c,l,u,d,f){if(o&&typeof o==`object`&&!Array.isArray(o)){t(o,s,c,l,u,d,f);for(var p in o){var m=o[p];if(Array.isArray(m)){if(p in n.arrayKeywords)for(var h=0;h<m.length;h++)r(e,t,a,m[h],s+`/`+p+`/`+h,c,s,p,o,h)}else if(p in n.propsKeywords){if(m&&typeof m==`object`)for(var g in m)r(e,t,a,m[g],s+`/`+p+`/`+i(g),c,s,p,o,g)}else if(p in n.keywords||e.allKeys&&!(p in n.skipKeywords))r(e,t,a,m,s+`/`+p,c,s,p,o)}a(o,s,c,l,u,d,f)}}function i(e){return e.replace(/~/g,`~0`).replace(/\//g,`~1`)}});var T=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.getSchemaRefs=exports.resolveUrl=exports.normalizeId=exports._getFullPath=exports.getFullPath=exports.inlineRef=void 0;const t=f();const n=C();const r=w();const i=new Set([`type`,`format`,`pattern`,`maxLength`,`minLength`,`maxProperties`,`minProperties`,`maxItems`,`minItems`,`maximum`,`minimum`,`uniqueItems`,`multipleOf`,`required`,`enum`,`const`]);function a(e,t=true){if(typeof e==`boolean`)return true;if(t===true)return!s(e);if(!t)return false;return c(e)<=t}exports.inlineRef=a;const o=new Set([`$ref`,`$recursiveRef`,`$recursiveAnchor`,`$dynamicRef`,`$dynamicAnchor`]);function s(e){for(const t in e){if(o.has(t))return true;const n=e[t];if(Array.isArray(n)&&n.some(s))return true;if(typeof n==`object`&&s(n))return true}return false}function c(e){let n=0;for(const r in e){if(r===`$ref`)return 1/0;n++;if(i.has(r))continue;if(typeof e[r]==`object`)(0,t.eachItem)(e[r],e=>n+=c(e));if(n===1/0)return 1/0}return n}function l(e,t=``,n){if(n!==false)t=p(t);const r=e.parse(t);return u(e,r)}exports.getFullPath=l;function u(e,t){const n=e.serialize(t);return n.split(`#`)[0]+`#`}exports._getFullPath=u;const d=/#\/?$/;function p(e){return e?e.replace(d,``):``}exports.normalizeId=p;function m(e,t,n){n=p(n);return e.resolve(t,n)}exports.resolveUrl=m;const h=/^[a-z_][-a-z0-9._]*$/i;function g(e,t){if(typeof e==`boolean`)return{};const{schemaId:i,uriResolver:a}=this.opts;const o=p(e[i]||t);const s={"":o};const c=l(a,o,false);const u={};const d=new Set;r(e,{allKeys:true},(e,t,n,r)=>{if(r===void 0)return;const a=c+t;let o=s[r];if(typeof e[i]==`string`)o=l.call(this,e[i]);g.call(this,e.$anchor);g.call(this,e.$dynamicAnchor);s[t]=o;function l(t){const n=this.opts.uriResolver.resolve;t=p(o?n(o,t):t);if(d.has(t))throw m(t);d.add(t);let r=this.refs[t];if(typeof r==`string`)r=this.refs[r];if(typeof r==`object`)f(e,r.schema,t);else if(t!==p(a))if(t[0]===`#`){f(e,u[t],t);u[t]=e}else this.refs[t]=a;return t}function g(e){if(typeof e==`string`){if(!h.test(e))throw new Error(`invalid anchor "${e}"`);l.call(this,`#${e}`)}}});return u;function f(e,t,r){if(t!==void 0&&!n(e,t))throw m(r)}function m(e){return new Error(`reference "${e}" resolves to more than one schema`)}}exports.getSchemaRefs=g});var E=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.getData=exports.KeywordCxt=exports.validateFunctionCode=void 0;const t=h();const n=v();const r=_();const i=v();const a=y();const o=x();const s=S();const c=d();const l=p();const u=T();const g=f();const b=m();function C(e){if(N(e)){F(e);if(M(e)){O(e);return}}w(e,()=>(0,t.topBoolOrEmptySchema)(e))}exports.validateFunctionCode=C;function w({gen:e,validateName:t,schema:n,schemaEnv:r,opts:i},a){if(i.code.es5)e.func(t,(0,c._)`${l.default.data}, ${l.default.valCxt}`,r.$async,()=>{e.code((0,c._)`"use strict"; ${A(n,i)}`);D(e,i);e.code(a)});else e.func(t,(0,c._)`${l.default.data}, ${E(i)}`,r.$async,()=>e.code(A(n,i)).code(a))}function E(e){return(0,c._)`{${l.default.instancePath}="", ${l.default.parentData}, ${l.default.parentDataProperty}, ${l.default.rootData}=${l.default.data}${e.dynamicRef?(0,c._)`, ${l.default.dynamicAnchors}={}`:c.nil}}={}`}function D(e,t){e.if(l.default.valCxt,()=>{e.var(l.default.instancePath,(0,c._)`${l.default.valCxt}.${l.default.instancePath}`);e.var(l.default.parentData,(0,c._)`${l.default.valCxt}.${l.default.parentData}`);e.var(l.default.parentDataProperty,(0,c._)`${l.default.valCxt}.${l.default.parentDataProperty}`);e.var(l.default.rootData,(0,c._)`${l.default.valCxt}.${l.default.rootData}`);if(t.dynamicRef)e.var(l.default.dynamicAnchors,(0,c._)`${l.default.valCxt}.${l.default.dynamicAnchors}`)},()=>{e.var(l.default.instancePath,(0,c._)`""`);e.var(l.default.parentData,(0,c._)`undefined`);e.var(l.default.parentDataProperty,(0,c._)`undefined`);e.var(l.default.rootData,l.default.data);if(t.dynamicRef)e.var(l.default.dynamicAnchors,(0,c._)`{}`)})}function O(e){const{schema:t,opts:n,gen:r}=e;w(e,()=>{if(n.$comment&&t.$comment)V(e);R(e);r.let(l.default.vErrors,null);r.let(l.default.errors,0);if(n.unevaluated)k(e);I(e);H(e)});return}function k(e){const{gen:t,validateName:n}=e;e.evaluated=t.const(`evaluated`,(0,c._)`${n}.evaluated`);t.if((0,c._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,c._)`${e.evaluated}.props`,(0,c._)`undefined`));t.if((0,c._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,c._)`${e.evaluated}.items`,(0,c._)`undefined`))}function A(e,t){const n=typeof e==`object`&&e[t.schemaId];return n&&(t.code.source||t.code.process)?(0,c._)`/*# sourceURL=${n} */`:c.nil}function j(e,n){if(N(e)){F(e);if(M(e)){P(e,n);return}}(0,t.boolOrEmptySchema)(e,n)}function M({schema:e,self:t}){if(typeof e==`boolean`)return!e;for(const n in e)if(t.RULES.all[n])return true;return false}function N(e){return typeof e.schema!=`boolean`}function P(e,t){const{schema:n,gen:r,opts:i}=e;if(i.$comment&&n.$comment)V(e);z(e);B(e);const a=r.const(`_errs`,l.default.errors);I(e,a);r.var(t,(0,c._)`${a} === ${l.default.errors}`)}function F(e){(0,g.checkUnknownRules)(e);L(e)}function I(e,t){if(e.opts.jtd)return W(e,[],false,t);const r=(0,n.getSchemaTypes)(e.schema);const i=(0,n.coerceAndCheckDataType)(e,r);W(e,r,!i,t)}function L(e){const{schema:t,errSchemaPath:n,opts:r,self:i}=e;if(t.$ref&&r.ignoreKeywordsWithRef&&(0,g.schemaHasRulesButRef)(t,i.RULES))i.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function R(e){const{schema:t,opts:n}=e;if(t.default!==void 0&&n.useDefaults&&n.strictSchema)(0,g.checkStrictMode)(e,`default is ignored in the schema root`)}function z(e){const t=e.schema[e.opts.schemaId];if(t)e.baseId=(0,u.resolveUrl)(e.opts.uriResolver,e.baseId,t)}function B(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error(`async schema in sync schema`)}function V({gen:e,schemaEnv:t,schema:n,errSchemaPath:r,opts:i}){const a=n.$comment;if(i.$comment===true)e.code((0,c._)`${l.default.self}.logger.log(${a})`);else if(typeof i.$comment==`function`){const n=(0,c.str)`${r}/$comment`;const i=e.scopeValue(`root`,{ref:t.root});e.code((0,c._)`${l.default.self}.opts.$comment(${a}, ${n}, ${i}.schema)`)}}function H(e){const{gen:t,schemaEnv:n,validateName:r,ValidationError:i,opts:a}=e;if(n.$async)t.if((0,c._)`${l.default.errors} === 0`,()=>t.return(l.default.data),()=>t.throw((0,c._)`new ${i}(${l.default.vErrors})`));else{t.assign((0,c._)`${r}.errors`,l.default.vErrors);if(a.unevaluated)U(e);t.return((0,c._)`${l.default.errors} === 0`)}}function U({gen:e,evaluated:t,props:n,items:r}){if(n instanceof c.Name)e.assign((0,c._)`${t}.props`,n);if(r instanceof c.Name)e.assign((0,c._)`${t}.items`,r)}function W(e,t,n,a){const{gen:o,schema:s,data:u,allErrors:d,opts:f,self:p}=e;const{RULES:m}=p;if(s.$ref&&(f.ignoreKeywordsWithRef||!(0,g.schemaHasRulesButRef)(s,m))){o.block(()=>te(e,`$ref`,m.all.$ref.definition));return}if(!f.jtd)K(e,t);o.block(()=>{for(const e of m.rules)h(e);h(m.post)});function h(p){if(!(0,r.shouldUseGroup)(s,p))return;if(p.type){o.if((0,i.checkDataType)(p.type,u,f.strictNumbers));G(e,p);if(t.length===1&&t[0]===p.type&&n){o.else();(0,i.reportTypeError)(e)}o.endIf()}else G(e,p);if(!d)o.if((0,c._)`${l.default.errors} === ${a||0}`)}}function G(e,t){const{gen:n,schema:i,opts:{useDefaults:o}}=e;if(o)(0,a.assignDefaults)(e,t.type);n.block(()=>{for(const n of t.rules)if((0,r.shouldUseRule)(i,n))te(e,n.keyword,n.definition,t.type)})}function K(e,t){if(e.schemaEnv.meta||!e.opts.strictTypes)return;q(e,t);if(!e.opts.allowUnionTypes)J(e,t);Y(e,e.dataTypes)}function q(e,t){if(!t.length)return;if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(t=>{if(!Z(e.dataTypes,t))$(e,`type "${t}" not allowed by context "${e.dataTypes.join(`,`)}"`)});Q(e,t)}function J(e,t){if(t.length>1&&!(t.length===2&&t.includes(`null`)))$(e,`use allowUnionTypes to allow union type keyword`)}function Y(e,t){const n=e.self.RULES.all;for(const i in n){const a=n[i];if(typeof a==`object`&&(0,r.shouldUseRule)(e.schema,a)){const{type:n}=a.definition;if(n.length&&!n.some(e=>X(t,e)))$(e,`missing type "${n.join(`,`)}" for keyword "${i}"`)}}}function X(e,t){return e.includes(t)||t===`number`&&e.includes(`integer`)}function Z(e,t){return e.includes(t)||t===`integer`&&e.includes(`number`)}function Q(e,t){const n=[];for(const r of e.dataTypes)if(Z(t,r))n.push(r);else if(t.includes(`integer`)&&r===`number`)n.push(`integer`);e.dataTypes=n}function $(e,t){const n=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${n}" (strictTypes)`;(0,g.checkStrictMode)(e,t,e.opts.strictTypes)}var ee=class{constructor(e,t,n){(0,o.validateKeywordUsage)(e,t,n);this.gen=e.gen;this.allErrors=e.allErrors;this.keyword=n;this.data=e.data;this.schema=e.schema[n];this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data;this.schemaValue=(0,g.schemaRefOrVal)(e,this.schema,n,this.$data);this.schemaType=t.schemaType;this.parentSchema=e.schema;this.params={};this.it=e;this.def=t;if(this.$data)this.schemaCode=e.gen.const(`vSchema`,ie(this.$data,e));else{this.schemaCode=this.schemaValue;if(!(0,o.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(t.schemaType)}`)}if(`code`in t?t.trackErrors:t.errors!==false)this.errsCount=e.gen.const(`_errs`,l.default.errors)}result(e,t,n){this.failResult((0,c.not)(e),t,n)}failResult(e,t,n){this.gen.if(e);if(n)n();else this.error();if(t){this.gen.else();t();if(this.allErrors)this.gen.endIf()}else if(this.allErrors)this.gen.endIf();else this.gen.else()}pass(e,t){this.failResult((0,c.not)(e),void 0,t)}fail(e){if(e===void 0){this.error();if(!this.allErrors)this.gen.if(false);return}this.gen.if(e);this.error();if(this.allErrors)this.gen.endIf();else this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail((0,c._)`${t} !== undefined && (${(0,c.or)(this.invalid$data(),e)})`)}error(e,t,n){if(t){this.setParams(t);this._error(e,n);this.setParams({});return}this._error(e,n)}_error(e,t){(e?b.reportExtraError:b.reportError)(this,this.def.error,t)}$dataError(){(0,b.reportError)(this,this.def.$dataError||b.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error(`add "trackErrors" to keyword definition`);(0,b.resetErrorsCount)(this.gen,this.errsCount)}ok(e){if(!this.allErrors)this.gen.if(e)}setParams(e,t){if(t)Object.assign(this.params,e);else this.params=e}block$data(e,t,n=c.nil){this.gen.block(()=>{this.check$data(e,n);t()})}check$data(e=c.nil,t=c.nil){if(!this.$data)return;const{gen:n,schemaCode:r,schemaType:i,def:a}=this;n.if((0,c.or)((0,c._)`${r} === undefined`,t));if(e!==c.nil)n.assign(e,true);if(i.length||a.validateSchema){n.elseIf(this.invalid$data());this.$dataError();if(e!==c.nil)n.assign(e,false)}n.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:n,def:r,it:a}=this;return(0,c.or)(o(),s());function o(){if(n.length){if(!(t instanceof c.Name))throw new Error(`ajv implementation error`);const e=Array.isArray(n)?n:[n];return(0,c._)`${(0,i.checkDataTypes)(e,t,a.opts.strictNumbers,i.DataType.Wrong)}`}return c.nil}function s(){if(r.validateSchema){const n=e.scopeValue(`validate$data`,{ref:r.validateSchema});return(0,c._)`!${n}(${t})`}return c.nil}}subschema(e,t){const n=(0,s.getSubschema)(this.it,e);(0,s.extendSubschemaData)(n,this.it,e);(0,s.extendSubschemaMode)(n,e);const r={...this.it,...n,items:void 0,props:void 0};j(r,t);return r}mergeEvaluated(e,t){const{it:n,gen:r}=this;if(!n.opts.unevaluated)return;if(n.props!==true&&e.props!==void 0)n.props=g.mergeEvaluated.props(r,e.props,n.props,t);if(n.items!==true&&e.items!==void 0)n.items=g.mergeEvaluated.items(r,e.items,n.items,t)}mergeValidEvaluated(e,t){const{it:n,gen:r}=this;if(n.opts.unevaluated&&(n.props!==true||n.items!==true)){r.if(t,()=>this.mergeEvaluated(e,c.Name));return true}}};exports.KeywordCxt=ee;function te(e,t,n,r){const i=new ee(e,n,t);if(`code`in n)n.code(i,r);else if(i.$data&&n.validate)(0,o.funcKeywordCode)(i,n);else if(`macro`in n)(0,o.macroKeywordCode)(i,n);else if(n.compile||n.validate)(0,o.funcKeywordCode)(i,n)}const ne=/^\/(?:[^~]|~0|~1)*$/;const re=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ie(e,{dataLevel:t,dataNames:n,dataPathArr:r}){let i;let a;if(e===``)return l.default.rootData;if(e[0]===`/`){if(!ne.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);i=e;a=l.default.rootData}else{const o=re.exec(e);if(!o)throw new Error(`Invalid JSON-pointer: ${e}`);const s=+o[1];i=o[2];if(i===`#`){if(s>=t)throw new Error(u(`property/index`,s));return r[t-s]}if(s>t)throw new Error(u(`data`,s));a=n[t-s];if(!i)return a}let o=a;const s=i.split(`/`);for(const e of s)if(e){a=(0,c._)`${a}${(0,c.getProperty)((0,g.unescapeJsonPointer)(e))}`;o=(0,c._)`${o} && ${a}`}return o;function u(e,n){return`Cannot access ${e} ${n} levels up, current level is ${t}`}}exports.getData=ie});var D=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});var t=class extends Error{constructor(e){super(`validation failed`);this.errors=e;this.ajv=this.validation=true}};exports.default=t});var O=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=T();var n=class extends Error{constructor(e,n,r,i){super(i||`can't resolve reference ${r} from id ${n}`);this.missingRef=(0,t.resolveUrl)(e,n,r);this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(e,this.missingRef))}};exports.default=n});var k=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.resolveSchema=exports.getCompilingSchema=exports.resolveRef=exports.compileSchema=exports.SchemaEnv=void 0;const t=d();const n=D();const r=p();const i=T();const a=f();const o=E();var s=class{constructor(e){var t;this.refs={};this.dynamicAnchors={};let n;if(typeof e.schema==`object`)n=e.schema;this.schema=e.schema;this.schemaId=e.schemaId;this.root=e.root||this;this.baseId=(t=e.baseId)!==null&&t!==void 0?t:(0,i.normalizeId)(n===null||n===void 0?void 0:n[e.schemaId||`$id`]);this.schemaPath=e.schemaPath;this.localRefs=e.localRefs;this.meta=e.meta;this.$async=n===null||n===void 0?void 0:n.$async;this.refs={}}};exports.SchemaEnv=s;function c(e){const a=m.call(this,e);if(a)return a;const s=(0,i.getFullPath)(this.opts.uriResolver,e.root.baseId);const{es5:c,lines:l}=this.opts.code;const{ownProperties:u}=this.opts;const d=new t.CodeGen(this.scope,{es5:c,lines:l,ownProperties:u});let f;if(e.$async)f=d.scopeValue(`Error`,{ref:n.default,code:(0,t._)`require("ajv/dist/runtime/validation_error").default`});const p=d.scopeName(`validate`);e.validateName=p;const h={gen:d,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:d.scopeValue(`schema`,this.opts.code.source===true?{ref:e.schema,code:(0,t.stringify)(e.schema)}:{ref:e.schema}),validateName:p,ValidationError:f,schema:e.schema,schemaEnv:e,rootId:s,baseId:e.baseId||s,schemaPath:t.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?``:`#`),errorPath:(0,t._)`""`,opts:this.opts,self:this};let g;try{this._compilations.add(e);(0,o.validateFunctionCode)(h);d.optimize(this.opts.code.optimize);const n=d.toString();g=`${d.scopeRefs(r.default.scope)}return ${n}`;if(this.opts.code.process)g=this.opts.code.process(g,e);const i=new Function(`${r.default.self}`,`${r.default.scope}`,g);const a=i(this,this.scope.get());this.scope.value(p,{ref:a});a.errors=null;a.schema=e.schema;a.schemaEnv=e;if(e.$async)a.$async=true;if(this.opts.code.source===true)a.source={validateName:p,validateCode:n,scopeValues:d._values};if(this.opts.unevaluated){const{props:e,items:n}=h;a.evaluated={props:e instanceof t.Name?void 0:e,items:n instanceof t.Name?void 0:n,dynamicProps:e instanceof t.Name,dynamicItems:n instanceof t.Name};if(a.source)a.source.evaluated=(0,t.stringify)(a.evaluated)}e.validate=a;return e}catch(t){delete e.validate;delete e.validateName;if(g)this.logger.error(`Error compiling schema, function code:`,g);throw t}finally{this._compilations.delete(e)}}exports.compileSchema=c;function l(e,t,n){var r;n=(0,i.resolveUrl)(this.opts.uriResolver,t,n);const a=e.refs[n];if(a)return a;let o=g.call(this,e,n);if(o===void 0){const i=(r=e.localRefs)===null||r===void 0?void 0:r[n];const{schemaId:a}=this.opts;if(i)o=new s({schema:i,schemaId:a,root:e,baseId:t})}if(o===void 0)return;return e.refs[n]=u.call(this,o)}exports.resolveRef=l;function u(e){if((0,i.inlineRef)(e.schema,this.opts.inlineRefs))return e.schema;return e.validate?e:c.call(this,e)}function m(e){for(const t of this._compilations)if(h(t,e))return t}exports.getCompilingSchema=m;function h(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function g(e,t){let n;while(typeof(n=this.refs[t])==`string`)t=n;return n||this.schemas[t]||_.call(this,e,t)}function _(e,t){const n=this.opts.uriResolver.parse(t);const r=(0,i._getFullPath)(this.opts.uriResolver,n);let a=(0,i.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&r===a)return y.call(this,n,e);const o=(0,i.normalizeId)(r);const l=this.refs[o]||this.schemas[o];if(typeof l==`string`){const t=_.call(this,e,l);if(typeof(t===null||t===void 0?void 0:t.schema)!==`object`)return;return y.call(this,n,t)}if(typeof(l===null||l===void 0?void 0:l.schema)!==`object`)return;if(!l.validate)c.call(this,l);if(o===(0,i.normalizeId)(t)){const{schema:t}=l;const{schemaId:n}=this.opts;const r=t[n];if(r)a=(0,i.resolveUrl)(this.opts.uriResolver,a,r);return new s({schema:t,schemaId:n,root:e,baseId:a})}return y.call(this,n,l)}exports.resolveSchema=_;const v=new Set([`properties`,`patternProperties`,`enum`,`dependencies`,`definitions`]);function y(e,{baseId:t,schema:n,root:r}){var o;if(((o=e.fragment)===null||o===void 0?void 0:o[0])!==`/`)return;for(const r of e.fragment.slice(1).split(`/`)){if(typeof n===`boolean`)return;const e=n[(0,a.unescapeFragment)(r)];if(e===void 0)return;n=e;const o=typeof n===`object`&&n[this.opts.schemaId];if(!v.has(r)&&o)t=(0,i.resolveUrl)(this.opts.uriResolver,t,o)}let c;if(typeof n!=`boolean`&&n.$ref&&!(0,a.schemaHasRulesButRef)(n,this.RULES)){const e=(0,i.resolveUrl)(this.opts.uriResolver,t,n.$ref);c=_.call(this,r,e)}const{schemaId:l}=this.opts;c=c||new s({schema:n,schemaId:l,root:r,baseId:t});if(c.schema!==c.root.schema)return c;return void 0}});var A=o((exports,t)=>{t.exports={"$id":`https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#`,"description":`Meta-schema for $data reference (JSON AnySchema extension proposal)`,"type":`object`,"required":[`$data`],"properties":{"$data":{"type":`string`,"anyOf":[{"format":`relative-json-pointer`},{"format":`json-pointer`}]}},"additionalProperties":false}});var j=o((exports,t)=>{const n={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};t.exports={HEX:n}});var M=o((exports,t)=>{const{HEX:n}=j();const r=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function i(e){if(l(e,`.`)<3)return{host:e,isIPV4:false};const t=e.match(r)||[];const[n]=t;if(n)return{host:c(n,`.`),isIPV4:true};else return{host:e,isIPV4:false}}function a(e,t=false){let r=``;let i=true;for(const t of e){if(n[t]===void 0)return void 0;if(t!==`0`&&i===true)i=false;if(!i)r+=t}if(t&&r.length===0)r=`0`;return r}function o(e){let t=0;const n={error:false,address:``,zone:``};const r=[];const i=[];let o=false;let s=false;let c=false;function l(){if(i.length){if(o===false){const e=a(i);if(e!==void 0)r.push(e);else{n.error=true;return false}}i.length=0}return true}for(let a=0;a<e.length;a++){const u=e[a];if(u===`[`||u===`]`)continue;if(u===`:`){if(s===true)c=true;if(!l())break;t++;r.push(`:`);if(t>7){n.error=true;break}if(a-1>=0&&e[a-1]===`:`)s=true;continue}else if(u===`%`){if(!l())break;o=true}else{i.push(u);continue}}if(i.length)if(o)n.zone=i.join(``);else if(c)r.push(i.join(``));else r.push(a(i));n.address=r.join(``);return n}function s(e){if(l(e,`:`)<2)return{host:e,isIPV6:false};const t=o(e);if(!t.error){let e=t.address;let n=t.address;if(t.zone){e+=`%`+t.zone;n+=`%25`+t.zone}return{host:e,escapedHost:n,isIPV6:true}}else return{host:e,isIPV6:false}}function c(e,t){let n=``;let r=true;const i=e.length;for(let a=0;a<i;a++){const o=e[a];if(o===`0`&&r){if(a+1<=i&&e[a+1]===t||a+1===i){n+=o;r=false}}else{if(o===t)r=true;else r=false;n+=o}}return n}function l(e,t){let n=0;for(let r=0;r<e.length;r++)if(e[r]===t)n++;return n}const u=/^\.\.?\//u;const d=/^\/\.(?:\/|$)/u;const f=/^\/\.\.(?:\/|$)/u;const p=/^\/?(?:.|\n)*?(?=\/|$)/u;function m(e){const t=[];while(e.length)if(e.match(u))e=e.replace(u,``);else if(e.match(d))e=e.replace(d,`/`);else if(e.match(f)){e=e.replace(f,`/`);t.pop()}else if(e===`.`||e===`..`)e=``;else{const n=e.match(p);if(n){const r=n[0];e=e.slice(r.length);t.push(r)}else throw new Error(`Unexpected dot segment condition`)}return t.join(``)}function h(e,t){const n=t!==true?escape:unescape;if(e.scheme!==void 0)e.scheme=n(e.scheme);if(e.userinfo!==void 0)e.userinfo=n(e.userinfo);if(e.host!==void 0)e.host=n(e.host);if(e.path!==void 0)e.path=n(e.path);if(e.query!==void 0)e.query=n(e.query);if(e.fragment!==void 0)e.fragment=n(e.fragment);return e}function g(e){const t=[];if(e.userinfo!==void 0){t.push(e.userinfo);t.push(`@`)}if(e.host!==void 0){let n=unescape(e.host);const r=i(n);if(r.isIPV4)n=r.host;else{const t=s(r.host);if(t.isIPV6===true)n=`[${t.escapedHost}]`;else n=e.host}t.push(n)}if(typeof e.port===`number`||typeof e.port===`string`){t.push(`:`);t.push(String(e.port))}return t.length?t.join(``):void 0}t.exports={recomposeAuthority:g,normalizeComponentEncoding:h,removeDotSegments:m,normalizeIPv4:i,normalizeIPv6:s,stringArrayToHexStripped:a}});var N=o((exports,t)=>{const n=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu;const r=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function i(e){return typeof e.secure===`boolean`?e.secure:String(e.scheme).toLowerCase()===`wss`}function a(e){if(!e.host)e.error=e.error||`HTTP URIs must have a host.`;return e}function o(e){const t=String(e.scheme).toLowerCase()===`https`;if(e.port===(t?443:80)||e.port===``)e.port=void 0;if(!e.path)e.path=`/`;return e}function s(e){e.secure=i(e);e.resourceName=(e.path||`/`)+(e.query?`?`+e.query:``);e.path=void 0;e.query=void 0;return e}function c(e){if(e.port===(i(e)?443:80)||e.port===``)e.port=void 0;if(typeof e.secure===`boolean`){e.scheme=e.secure?`wss`:`ws`;e.secure=void 0}if(e.resourceName){const[t,n]=e.resourceName.split(`?`);e.path=t&&t!==`/`?t:void 0;e.query=n;e.resourceName=void 0}e.fragment=void 0;return e}function l(e,t){if(!e.path){e.error=`URN can not be parsed`;return e}const n=e.path.match(r);if(n){const r=t.scheme||e.scheme||`urn`;e.nid=n[1].toLowerCase();e.nss=n[2];const i=`${r}:${t.nid||e.nid}`;const a=y[i];e.path=void 0;if(a)e=a.parse(e,t)}else e.error=e.error||`URN can not be parsed.`;return e}function u(e,t){const n=t.scheme||e.scheme||`urn`;const r=e.nid.toLowerCase();const i=`${n}:${t.nid||r}`;const a=y[i];if(a)e=a.serialize(e,t);const o=e;const s=e.nss;o.path=`${r||t.nid}:${s}`;t.skipEscape=true;return o}function d(e,t){const r=e;r.uuid=r.nss;r.nss=void 0;if(!t.tolerant&&(!r.uuid||!n.test(r.uuid)))r.error=r.error||`UUID is not valid.`;return r}function f(e){const t=e;t.nss=(e.uuid||``).toLowerCase();return t}const p={scheme:`http`,domainHost:true,parse:a,serialize:o};const m={scheme:`https`,domainHost:p.domainHost,parse:a,serialize:o};const h={scheme:`ws`,domainHost:true,parse:s,serialize:c};const g={scheme:`wss`,domainHost:h.domainHost,parse:h.parse,serialize:h.serialize};const _={scheme:`urn`,parse:l,serialize:u,skipNormalize:true};const v={scheme:`urn:uuid`,parse:d,serialize:f,skipNormalize:true};const y={http:p,https:m,ws:h,wss:g,urn:_,"urn:uuid":v};t.exports=y});var P=o((exports,t)=>{const{normalizeIPv6:n,normalizeIPv4:r,removeDotSegments:i,recomposeAuthority:a,normalizeComponentEncoding:o}=M();const s=N();function c(e,t){if(typeof e===`string`)e=f(g(e,t),t);else if(typeof e===`object`)e=g(f(e,t),t);return e}function l(e,t,n){const r=Object.assign({scheme:`null`},n);const i=u(g(e,r),g(t,r),r,true);return f(i,{...r,skipEscape:true})}function u(e,t,n,r){const a={};if(!r){e=g(f(e,n),n);t=g(f(t,n),n)}n=n||{};if(!n.tolerant&&t.scheme){a.scheme=t.scheme;a.userinfo=t.userinfo;a.host=t.host;a.port=t.port;a.path=i(t.path||``);a.query=t.query}else{if(t.userinfo!==void 0||t.host!==void 0||t.port!==void 0){a.userinfo=t.userinfo;a.host=t.host;a.port=t.port;a.path=i(t.path||``);a.query=t.query}else{if(!t.path){a.path=e.path;if(t.query!==void 0)a.query=t.query;else a.query=e.query}else{if(t.path.charAt(0)===`/`)a.path=i(t.path);else{if((e.userinfo!==void 0||e.host!==void 0||e.port!==void 0)&&!e.path)a.path=`/`+t.path;else if(!e.path)a.path=t.path;else a.path=e.path.slice(0,e.path.lastIndexOf(`/`)+1)+t.path;a.path=i(a.path)}a.query=t.query}a.userinfo=e.userinfo;a.host=e.host;a.port=e.port}a.scheme=e.scheme}a.fragment=t.fragment;return a}function d(e,t,n){if(typeof e===`string`){e=unescape(e);e=f(o(g(e,n),true),{...n,skipEscape:true})}else if(typeof e===`object`)e=f(o(e,true),{...n,skipEscape:true});if(typeof t===`string`){t=unescape(t);t=f(o(g(t,n),true),{...n,skipEscape:true})}else if(typeof t===`object`)t=f(o(t,true),{...n,skipEscape:true});return e.toLowerCase()===t.toLowerCase()}function f(e,t){const n={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:``};const r=Object.assign({},t);const o=[];const c=s[(r.scheme||n.scheme||``).toLowerCase()];if(c&&c.serialize)c.serialize(n,r);if(n.path!==void 0)if(!r.skipEscape){n.path=escape(n.path);if(n.scheme!==void 0)n.path=n.path.split(`%3A`).join(`:`)}else n.path=unescape(n.path);if(r.reference!==`suffix`&&n.scheme)o.push(n.scheme,`:`);const l=a(n);if(l!==void 0){if(r.reference!==`suffix`)o.push(`//`);o.push(l);if(n.path&&n.path.charAt(0)!==`/`)o.push(`/`)}if(n.path!==void 0){let e=n.path;if(!r.absolutePath&&(!c||!c.absolutePath))e=i(e);if(l===void 0)e=e.replace(/^\/\//u,`/%2F`);o.push(e)}if(n.query!==void 0)o.push(`?`,n.query);if(n.fragment!==void 0)o.push(`#`,n.fragment);return o.join(``)}const p=Array.from({length:127},(e,t)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(t)));function m(e){let t=0;for(let n=0,r=e.length;n<r;++n){t=e.charCodeAt(n);if(t>126||p[t])return true}return false}const h=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function g(e,t){const i=Object.assign({},t);const a={scheme:void 0,userinfo:void 0,host:``,port:void 0,path:``,query:void 0,fragment:void 0};const o=e.indexOf(`%`)!==-1;let c=false;if(i.reference===`suffix`)e=(i.scheme?i.scheme+`:`:``)+`//`+e;const l=e.match(h);if(l){a.scheme=l[1];a.userinfo=l[3];a.host=l[4];a.port=parseInt(l[5],10);a.path=l[6]||``;a.query=l[7];a.fragment=l[8];if(isNaN(a.port))a.port=l[5];if(a.host){const e=r(a.host);if(e.isIPV4===false){const t=n(e.host);a.host=t.host.toLowerCase();c=t.isIPV6}else{a.host=e.host;c=true}}if(a.scheme===void 0&&a.userinfo===void 0&&a.host===void 0&&a.port===void 0&&a.query===void 0&&!a.path)a.reference=`same-document`;else if(a.scheme===void 0)a.reference=`relative`;else if(a.fragment===void 0)a.reference=`absolute`;else a.reference=`uri`;if(i.reference&&i.reference!==`suffix`&&i.reference!==a.reference)a.error=a.error||`URI is not a `+i.reference+` reference.`;const e=s[(i.scheme||a.scheme||``).toLowerCase()];if(!i.unicodeSupport&&(!e||!e.unicodeSupport)){if(a.host&&(i.domainHost||e&&e.domainHost)&&c===false&&m(a.host))try{a.host=URL.domainToASCII(a.host.toLowerCase())}catch(e){a.error=a.error||`Host's domain name can not be converted to ASCII: `+e}}if(!e||e&&!e.skipNormalize){if(o&&a.scheme!==void 0)a.scheme=unescape(a.scheme);if(o&&a.host!==void 0)a.host=unescape(a.host);if(a.path)a.path=escape(unescape(a.path));if(a.fragment)a.fragment=encodeURI(decodeURIComponent(a.fragment))}if(e&&e.parse)e.parse(a,i)}else a.error=a.error||`URI can not be parsed.`;return a}const _={SCHEMES:s,normalize:c,resolve:l,resolveComponents:u,equal:d,serialize:f,parse:g};t.exports=_;t.exports.default=_;t.exports.fastUri=_});var F=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=P();t.code=`require("ajv/dist/runtime/uri").default`;exports.default=t});var I=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;var t=E();Object.defineProperty(exports,`KeywordCxt`,{enumerable:true,get:function(){return t.KeywordCxt}});var n=d();Object.defineProperty(exports,`_`,{enumerable:true,get:function(){return n._}});Object.defineProperty(exports,`str`,{enumerable:true,get:function(){return n.str}});Object.defineProperty(exports,`stringify`,{enumerable:true,get:function(){return n.stringify}});Object.defineProperty(exports,`nil`,{enumerable:true,get:function(){return n.nil}});Object.defineProperty(exports,`Name`,{enumerable:true,get:function(){return n.Name}});Object.defineProperty(exports,`CodeGen`,{enumerable:true,get:function(){return n.CodeGen}});const r=D();const i=O();const a=g();const o=k();const s=d();const c=T();const l=v();const u=f();const p=A();const m=F();const h=(e,t)=>new RegExp(e,t);h.code=`new RegExp`;const _=[`removeAdditional`,`useDefaults`,`coerceTypes`];const y=new Set([`validate`,`serialize`,`parse`,`wrapper`,`root`,`schema`,`keyword`,`pattern`,`formats`,`validate$data`,`func`,`obj`,`Error`]);const b={errorDataPath:``,format:"`validateFormats: false` can be used instead.",nullable:`"nullable" keyword is supported by default.`,jsonPointers:`Deprecated jsPropertySyntax can be used instead.`,extendRefs:`Deprecated ignoreKeywordsWithRef can be used instead.`,missingRefs:`Pass empty schema with $id that should be ignored to ajv.addSchema.`,processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:`"uniqueItems" keyword is always validated.`,unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:`Map is used as cache, schema object as key.`,serialize:`Map is used as cache, schema object as key.`,ajvErrors:`It is default now.`};const x={ignoreKeywordsWithRef:``,jsPropertySyntax:``,unicode:`"minLength"/"maxLength" account for unicode characters by default.`};const S=200;function C(e){var t,n,r,i,a,o,s,c,l,u,d,f,p,g,_,v,y,b,x,C,w,T,E,D,O;const k=e.strict;const A=(t=e.code)===null||t===void 0?void 0:t.optimize;const j=A===true||A===void 0?1:A||0;const M=(r=(n=e.code)===null||n===void 0?void 0:n.regExp)!==null&&r!==void 0?r:h;const N=(i=e.uriResolver)!==null&&i!==void 0?i:m.default;return{strictSchema:(o=(a=e.strictSchema)!==null&&a!==void 0?a:k)!==null&&o!==void 0?o:true,strictNumbers:(c=(s=e.strictNumbers)!==null&&s!==void 0?s:k)!==null&&c!==void 0?c:true,strictTypes:(u=(l=e.strictTypes)!==null&&l!==void 0?l:k)!==null&&u!==void 0?u:`log`,strictTuples:(f=(d=e.strictTuples)!==null&&d!==void 0?d:k)!==null&&f!==void 0?f:`log`,strictRequired:(g=(p=e.strictRequired)!==null&&p!==void 0?p:k)!==null&&g!==void 0?g:false,code:e.code?{...e.code,optimize:j,regExp:M}:{optimize:j,regExp:M},loopRequired:(_=e.loopRequired)!==null&&_!==void 0?_:S,loopEnum:(v=e.loopEnum)!==null&&v!==void 0?v:S,meta:(y=e.meta)!==null&&y!==void 0?y:true,messages:(b=e.messages)!==null&&b!==void 0?b:true,inlineRefs:(x=e.inlineRefs)!==null&&x!==void 0?x:true,schemaId:(C=e.schemaId)!==null&&C!==void 0?C:`$id`,addUsedSchema:(w=e.addUsedSchema)!==null&&w!==void 0?w:true,validateSchema:(T=e.validateSchema)!==null&&T!==void 0?T:true,validateFormats:(E=e.validateFormats)!==null&&E!==void 0?E:true,unicodeRegExp:(D=e.unicodeRegExp)!==null&&D!==void 0?D:true,int32range:(O=e.int32range)!==null&&O!==void 0?O:true,uriResolver:N}}var w=class{constructor(e={}){this.schemas={};this.refs={};this.formats={};this._compilations=new Set;this._loading={};this._cache=new Map;e=this.opts={...e,...C(e)};const{es5:t,lines:n}=this.opts.code;this.scope=new s.ValueScope({scope:{},prefixes:y,es5:t,lines:n});this.logger=z(e.logger);const r=e.validateFormats;e.validateFormats=false;this.RULES=(0,a.getRules)();j.call(this,b,e,`NOT SUPPORTED`);j.call(this,x,e,`DEPRECATED`,`warn`);this._metaOpts=L.call(this);if(e.formats)P.call(this);this._addVocabularies();this._addDefaultMetaSchema();if(e.keywords)I.call(this,e.keywords);if(typeof e.meta==`object`)this.addMetaSchema(e.meta);N.call(this);e.validateFormats=r}_addVocabularies(){this.addKeyword(`$async`)}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:n}=this.opts;let r=p;if(n===`id`){r={...p};r.id=r.$id;delete r.$id}if(t&&e)this.addMetaSchema(r,r[n],false)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta=typeof e==`object`?e[t]||e:void 0}validate(e,t){let n;if(typeof e==`string`){n=this.getSchema(e);if(!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);const r=n(t);if(!(`$async`in n))this.errors=n.errors;return r}compile(e,t){const n=this._addSchema(e,t);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,t){if(typeof this.opts.loadSchema!=`function`)throw new Error(`options.loadSchema should be a function`);const{loadSchema:n}=this.opts;return r.call(this,e,t);async function r(e,t){await a.call(this,e.$schema);const n=this._addSchema(e,t);return n.validate||o.call(this,n)}async function a(e){if(e&&!this.getSchema(e))await r.call(this,{$ref:e},true)}async function o(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof i.default))throw t;s.call(this,t);await c.call(this,t.missingSchema);return o.call(this,e)}}function s({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function c(e){const n=await l.call(this,e);if(!this.refs[e])await a.call(this,n.$schema);if(!this.refs[e])this.addSchema(n,e,t)}async function l(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=n(e))}finally{delete this._loading[e]}}}addSchema(e,t,n,r=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,n,r);return this}let i;if(typeof e===`object`){const{schemaId:t}=this.opts;i=e[t];if(i!==void 0&&typeof i!=`string`)throw new Error(`schema ${t} must be string`)}t=(0,c.normalizeId)(t||i);this._checkUnique(t);this.schemas[t]=this._addSchema(e,n,t,r,true);return this}addMetaSchema(e,t,n=this.opts.validateSchema){this.addSchema(e,t,true,n);return this}validateSchema(e,t){if(typeof e==`boolean`)return true;let n;n=e.$schema;if(n!==void 0&&typeof n!=`string`)throw new Error(`$schema must be a string`);n=n||this.opts.defaultMeta||this.defaultMeta();if(!n){this.logger.warn(`meta-schema not available`);this.errors=null;return true}const r=this.validate(n,e);if(!r&&t){const e=`schema is invalid: `+this.errorsText();if(this.opts.validateSchema===`log`)this.logger.error(e);else throw new Error(e)}return r}getSchema(e){let t;while(typeof(t=M.call(this,e))==`string`)e=t;if(t===void 0){const{schemaId:n}=this.opts;const r=new o.SchemaEnv({schema:{},schemaId:n});t=o.resolveSchema.call(this,r,e);if(!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp){this._removeAllSchemas(this.schemas,e);this._removeAllSchemas(this.refs,e);return this}switch(typeof e){case`undefined`:this._removeAllSchemas(this.schemas);this._removeAllSchemas(this.refs);this._cache.clear();return this;case`string`:{const t=M.call(this,e);if(typeof t==`object`)this._cache.delete(t.schema);delete this.schemas[e];delete this.refs[e];return this}case`object`:{const t=e;this._cache.delete(t);let n=e[this.opts.schemaId];if(n){n=(0,c.normalizeId)(n);delete this.schemas[n];delete this.refs[n]}return this}default:throw new Error(`ajv.removeSchema: invalid parameter`)}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let n;if(typeof e==`string`){n=e;if(typeof t==`object`){this.logger.warn(`these parameters are deprecated, see docs for addKeyword`);t.keyword=n}}else if(typeof e==`object`&&t===void 0){t=e;n=t.keyword;if(Array.isArray(n)&&!n.length)throw new Error(`addKeywords: keyword must be string or non-empty array`)}else throw new Error(`invalid addKeywords parameters`);V.call(this,n,t);if(!t){(0,u.eachItem)(n,e=>H.call(this,e));return this}W.call(this,t);const r={...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)};(0,u.eachItem)(n,r.type.length===0?e=>H.call(this,e,r):e=>r.type.forEach(t=>H.call(this,e,r,t)));return this}getKeyword(e){const t=this.RULES.all[e];return typeof t==`object`?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e];delete t.all[e];for(const n of t.rules){const t=n.rules.findIndex(t=>t.keyword===e);if(t>=0)n.rules.splice(t,1)}return this}addFormat(e,t){if(typeof t==`string`)t=new RegExp(t);this.formats[e]=t;return this}errorsText(e=this.errors,{separator:t=`, `,dataVar:n=`data`}={}){if(!e||e.length===0)return`No errors`;return e.map(e=>`${n}${e.instancePath} ${e.message}`).reduce((e,n)=>e+t+n)}$dataMetaSchema(e,t){const n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const r of t){const t=r.split(`/`).slice(1);let i=e;for(const e of t)i=i[e];for(const e in n){const t=n[e];if(typeof t!=`object`)continue;const{$data:r}=t.definition;const a=i[e];if(r&&a)i[e]=K(a)}}return e}_removeAllSchemas(e,t){for(const n in e){const r=e[n];if(!t||t.test(n)){if(typeof r==`string`)delete e[n];else if(r&&!r.meta){this._cache.delete(r.schema);delete e[n]}}}}_addSchema(e,t,n,r=this.opts.validateSchema,i=this.opts.addUsedSchema){let a;const{schemaId:s}=this.opts;if(typeof e==`object`)a=e[s];else if(this.opts.jtd)throw new Error(`schema must be object`);else if(typeof e!=`boolean`)throw new Error(`schema must be object or boolean`);let l=this._cache.get(e);if(l!==void 0)return l;n=(0,c.normalizeId)(a||n);const u=c.getSchemaRefs.call(this,e,n);l=new o.SchemaEnv({schema:e,schemaId:s,meta:t,baseId:n,localRefs:u});this._cache.set(l.schema,l);if(i&&!n.startsWith(`#`)){if(n)this._checkUnique(n);this.refs[n]=l}if(r)this.validateSchema(e,true);return l}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta)this._compileMetaSchema(e);else o.compileSchema.call(this,e);if(!e.validate)throw new Error(`ajv implementation error`);return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,e)}finally{this.opts=t}}};w.ValidationError=r.default;w.MissingRefError=i.default;exports.default=w;function j(e,t,n,r=`error`){for(const i in e){const a=i;if(a in t)this.logger[r](`${n}: option ${i}. ${e[a]}`)}}function M(e){e=(0,c.normalizeId)(e);return this.schemas[e]||this.refs[e]}function N(){const e=this.opts.schemas;if(!e)return;if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function P(){for(const e in this.opts.formats){const t=this.opts.formats[e];if(t)this.addFormat(e,t)}}function I(e){if(Array.isArray(e)){this.addVocabulary(e);return}this.logger.warn(`keywords option as map is deprecated, pass array`);for(const t in e){const n=e[t];if(!n.keyword)n.keyword=t;this.addKeyword(n)}}function L(){const e={...this.opts};for(const t of _)delete e[t];return e}const R={log(){},warn(){},error(){}};function z(e){if(e===false)return R;if(e===void 0)return console;if(e.log&&e.warn&&e.error)return e;throw new Error(`logger must implement log, warn and error methods`)}const B=/^[a-z_$][a-z0-9_$:-]*$/i;function V(e,t){const{RULES:n}=this;(0,u.eachItem)(e,e=>{if(n.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!B.test(e))throw new Error(`Keyword ${e} has invalid name`)});if(!t)return;if(t.$data&&!(`code`in t||`validate`in t))throw new Error(`$data keyword must have "code" or "validate" function`)}function H(e,t,n){var r;const i=t===null||t===void 0?void 0:t.post;if(n&&i)throw new Error(`keyword with "post" flag cannot have "type"`);const{RULES:a}=this;let o=i?a.post:a.rules.find(({type:e})=>e===n);if(!o){o={type:n,rules:[]};a.rules.push(o)}a.keywords[e]=true;if(!t)return;const s={keyword:e,definition:{...t,type:(0,l.getJSONTypes)(t.type),schemaType:(0,l.getJSONTypes)(t.schemaType)}};if(t.before)U.call(this,o,s,t.before);else o.rules.push(s);a.all[e]=s;(r=t.implements)===null||r===void 0||r.forEach(e=>this.addKeyword(e))}function U(e,t,n){const r=e.rules.findIndex(e=>e.keyword===n);if(r>=0)e.rules.splice(r,0,t);else{e.rules.push(t);this.logger.warn(`rule ${n} is not defined`)}}function W(e){let{metaSchema:t}=e;if(t===void 0)return;if(e.$data&&this.opts.$data)t=K(t);e.validateSchema=this.compile(t,true)}const G={$ref:`https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#`};function K(e){return{anyOf:[e,G]}}});var L=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.callRef=exports.getValidate=void 0;const t=O();const n=b();const r=d();const i=p();const a=k();const o=f();const s={keyword:`$ref`,schemaType:`string`,code(e){const{gen:n,schema:i,it:o}=e;const{baseId:s,schemaEnv:u,validateName:d,opts:f,self:p}=o;const{root:m}=u;if((i===`#`||i===`#/`)&&s===m.baseId)return g();const h=a.resolveRef.call(p,m,s,i);if(h===void 0)throw new t.default(o.opts.uriResolver,s,i);if(h instanceof a.SchemaEnv)return _(h);return v(h);function g(){if(u===m)return l(e,d,u,u.$async);const t=n.scopeValue(`root`,{ref:m});return l(e,(0,r._)`${t}.validate`,m,m.$async)}function _(t){const n=c(e,t);l(e,n,t,t.$async)}function v(t){const a=n.scopeValue(`schema`,f.code.source===true?{ref:t,code:(0,r.stringify)(t)}:{ref:t});const o=n.name(`valid`);const s=e.subschema({schema:t,dataTypes:[],schemaPath:r.nil,topSchemaRef:a,errSchemaPath:i},o);e.mergeEvaluated(s);e.ok(o)}}};function c(e,t){const{gen:n}=e;return t.validate?n.scopeValue(`validate`,{ref:t.validate}):(0,r._)`${n.scopeValue(`wrapper`,{ref:t})}.validate`}exports.getValidate=c;function l(e,t,a,s){const{gen:c,it:l}=e;const{allErrors:u,schemaEnv:d,opts:f}=l;const p=f.passContext?i.default.this:r.nil;if(s)m();else h();function m(){if(!d.$async)throw new Error(`async schema referenced by sync schema`);const i=c.let(`valid`);c.try(()=>{c.code((0,r._)`await ${(0,n.callValidateCode)(e,t,p)}`);_(t);if(!u)c.assign(i,true)},e=>{c.if((0,r._)`!(${e} instanceof ${l.ValidationError})`,()=>c.throw(e));g(e);if(!u)c.assign(i,false)});e.ok(i)}function h(){e.result((0,n.callValidateCode)(e,t,p),()=>_(t),()=>g(t))}function g(e){const t=(0,r._)`${e}.errors`;c.assign(i.default.vErrors,(0,r._)`${i.default.vErrors} === null ? ${t} : ${i.default.vErrors}.concat(${t})`);c.assign(i.default.errors,(0,r._)`${i.default.vErrors}.length`)}function _(e){var t;if(!l.opts.unevaluated)return;const n=(t=a===null||a===void 0?void 0:a.validate)===null||t===void 0?void 0:t.evaluated;if(l.props!==true)if(n&&!n.dynamicProps){if(n.props!==void 0)l.props=o.mergeEvaluated.props(c,n.props,l.props)}else{const t=c.var(`props`,(0,r._)`${e}.evaluated.props`);l.props=o.mergeEvaluated.props(c,t,l.props,r.Name)}if(l.items!==true)if(n&&!n.dynamicItems){if(n.items!==void 0)l.items=o.mergeEvaluated.items(c,n.items,l.items)}else{const t=c.var(`items`,(0,r._)`${e}.evaluated.items`);l.items=o.mergeEvaluated.items(c,t,l.items,r.Name)}}}exports.callRef=l;exports.default=s});var R=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.checkMetadata=void 0;const t=f();const n={keyword:`metadata`,schemaType:`object`,code(e){r(e);const{gen:n,schema:i,it:a}=e;if((0,t.alwaysValidSchema)(a,i))return;const o=n.name(`valid`);e.subschema({keyword:`metadata`,jtdMetadata:true},o);e.ok(o)}};function r({it:e,keyword:t},n){if(e.jtdMetadata!==n)throw new Error(`JTD: "${t}" cannot be used in this schema location`)}exports.checkMetadata=r;exports.default=n});var z=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.hasRef=void 0;const t=k();const n=d();const r=O();const i=p();const a=L();const o=R();const s={keyword:`ref`,schemaType:`string`,code(e){(0,o.checkMetadata)(e);const{gen:s,data:l,schema:u,parentSchema:d,it:f}=e;const{schemaEnv:{root:p}}=f;const m=s.name(`valid`);if(d.nullable){s.var(m,(0,n._)`${l} === null`);s.if((0,n.not)(m),h)}else{s.var(m,false);h()}e.ok(m);function h(){var e;const t=(e=p.schema.definitions)===null||e===void 0?void 0:e[u];if(!t)throw new r.default(f.opts.uriResolver,``,u,`No definition ${u}`);if(c(t)||!f.opts.inlineRefs)g(t);else _(t)}function g(r){const o=t.compileSchema.call(f.self,new t.SchemaEnv({schema:r,root:p,schemaPath:`/definitions/${u}`}));const c=(0,a.getValidate)(e,o);const l=s.const(`_errs`,i.default.errors);(0,a.callRef)(e,c,o,o.$async);s.assign(m,(0,n._)`${l} === ${i.default.errors}`)}function _(t){const r=s.scopeValue(`schema`,f.opts.code.source===true?{ref:t,code:(0,n.stringify)(t)}:{ref:t});e.subschema({schema:t,dataTypes:[],schemaPath:n.nil,topSchemaRef:r,errSchemaPath:`/definitions/${u}`},m)}}};function c(e){for(const t in e){let n;if(t===`ref`||typeof(n=e[t])==`object`&&c(n))return true}return false}exports.hasRef=c;exports.default=s});var B=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=/t|\s/i;const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/;const r=/^(\d\d):(\d\d):(\d\d)(?:\.\d+)?(?:z|([+-]\d\d)(?::?(\d\d))?)$/i;const i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function a(e,n){const r=e.split(t);return r.length===2&&o(r[0])&&s(r[1])||n&&r.length===1&&o(r[0])}exports.default=a;function o(e){const t=n.exec(e);if(!t)return false;const r=+t[1];const a=+t[2];const o=+t[3];return a>=1&&a<=12&&o>=1&&(o<=i[a]||a===2&&o===29&&(r%100===0?r%400===0:r%4===0))}function s(e){const t=r.exec(e);if(!t)return false;const n=+t[1];const i=+t[2];const a=+t[3];const o=+(t[4]||0);const s=+(t[5]||0);return n<=23&&i<=59&&a<=59||n-o===23&&i-s===59&&a===60}a.code=`require("ajv/dist/runtime/timestamp").default`});var V=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.typeErrorParams=exports.typeErrorMessage=exports.typeError=void 0;const t=d();function n(e){return{message:t=>r(t,e),params:t=>i(t,e)}}exports.typeError=n;function r({parentSchema:e},t){return(e===null||e===void 0?void 0:e.nullable)?`must be ${t} or null`:`must be ${t}`}exports.typeErrorMessage=r;function i({parentSchema:e},n){return(0,t._)`{type: ${n}, nullable: ${!!(e===null||e===void 0?void 0:e.nullable)}}`}exports.typeErrorParams=i});var H=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.intRange=void 0;const t=d();const n=B();const r=f();const i=R();const a=V();exports.intRange={int8:[-128,127,3],uint8:[0,255,3],int16:[-32768,32767,5],uint16:[0,65535,5],int32:[-2147483648,2147483647,10],uint32:[0,4294967295,10]};const o={message:e=>(0,a.typeErrorMessage)(e,e.schema),params:e=>(0,a.typeErrorParams)(e,e.schema)};function s(e){const{gen:i,data:a,it:o}=e;const{timestamp:s,allowDate:c}=o.opts;if(s===`date`)return(0,t._)`${a} instanceof Date `;const l=(0,r.useFunc)(i,n.default);const u=c?(0,t._)`, true`:t.nil;const d=(0,t._)`typeof ${a} == "string" && ${l}(${a}${u})`;return s===`string`?d:(0,t.or)((0,t._)`${a} instanceof Date`,d)}const c={keyword:`type`,schemaType:`string`,error:o,code(n){(0,i.checkMetadata)(n);const{data:r,schema:a,parentSchema:o,it:c}=n;let l;switch(a){case`boolean`:case`string`:l=(0,t._)`typeof ${r} == ${a}`;break;case`timestamp`:{l=s(n);break}case`float32`:case`float64`:l=(0,t._)`typeof ${r} == "number"`;break;default:{const n=a;l=(0,t._)`typeof ${r} == "number" && isFinite(${r}) && !(${r} % 1)`;if(!c.opts.int32range&&(n===`int32`||n===`uint32`)){if(n===`uint32`)l=(0,t._)`${l} && ${r} >= 0`}else{const[i,a]=exports.intRange[n];l=(0,t._)`${l} && ${r} >= ${i} && ${r} <= ${a}`}}}n.pass(o.nullable?(0,t.or)((0,t._)`${r} === null`,l):l)}};exports.default=c});var U=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.checkNullableObject=exports.checkNullable=void 0;const t=d();function n({gen:e,data:n,parentSchema:r},i=t.nil){const a=e.name(`valid`);if(r.nullable){e.let(a,(0,t._)`${n} === null`);i=(0,t.not)(a)}else e.let(a,false);return[a,i]}exports.checkNullable=n;function r(e,r){const[i,a]=n(e,r);return[i,(0,t._)`${a} && typeof ${e.data} == "object" && !Array.isArray(${e.data})`]}exports.checkNullableObject=r});var W=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=d();const n=R();const r=U();const i={message:`must be equal to one of the allowed values`,params:({schemaCode:e})=>(0,t._)`{allowedValues: ${e}}`};const a={keyword:`enum`,schemaType:`array`,error:i,code(e){(0,n.checkMetadata)(e);const{gen:i,data:a,schema:o,schemaValue:s,parentSchema:c,it:l}=e;if(o.length===0)throw new Error(`enum must have non-empty array`);if(o.length!==new Set(o).size)throw new Error(`enum items must be unique`);let u;const d=(0,t._)`typeof ${a} == "string"`;if(o.length>=l.opts.loopEnum){let t;[u,t]=(0,r.checkNullable)(e,d);i.if(t,f)}else{if(!Array.isArray(o))throw new Error(`ajv implementation error`);u=(0,t.and)(d,(0,t.or)(...o.map(e=>(0,t._)`${a} === ${e}`)));if(c.nullable)u=(0,t.or)((0,t._)`${a} === null`,u)}e.pass(u);function f(){i.forOf(`v`,s,e=>i.if((0,t._)`${u} = ${a} === ${e}`,()=>i.break()))}}};exports.default=a});var G=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=f();const n=b();const r=d();const i=R();const a=U();const o=V();const s={keyword:`elements`,schemaType:`object`,error:(0,o.typeError)(`array`),code(e){(0,i.checkMetadata)(e);const{gen:o,data:s,schema:c,it:l}=e;if((0,t.alwaysValidSchema)(l,c))return;const[u]=(0,a.checkNullable)(e);o.if((0,r.not)(u),()=>o.if((0,r._)`Array.isArray(${s})`,()=>o.assign(u,(0,n.validateArray)(e)),()=>e.error()));e.ok(u)}};exports.default=s});var K=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.validateProperties=exports.error=void 0;const t=b();const n=f();const r=d();const i=R();const a=U();const o=V();var s;(function(e){e[`Additional`]=`additional`;e[`Missing`]=`missing`})(s||(s={}));exports.error={message:e=>{const{params:t}=e;return t.propError?t.propError===s.Additional?`must NOT have additional properties`:`must have property '${t.missingProperty}'`:(0,o.typeErrorMessage)(e,`object`)},params:e=>{const{params:t}=e;return t.propError?t.propError===s.Additional?(0,r._)`{error: ${t.propError}, additionalProperty: ${t.additionalProperty}}`:(0,r._)`{error: ${t.propError}, missingProperty: ${t.missingProperty}}`:(0,o.typeErrorParams)(e,`object`)}};const c={keyword:`properties`,schemaType:`object`,error:exports.error,code:l};function l(e){(0,i.checkMetadata)(e);const{gen:o,data:c,parentSchema:l,it:u}=e;const{additionalProperties:d,nullable:f}=l;if(u.jtdDiscriminator&&f)throw new Error(`JTD: nullable inside discriminator mapping`);if(y())throw new Error(`JTD: properties and optionalProperties have common members`);const[p,m]=b(`properties`);const[h,g]=b(`optionalProperties`);if(m.length===0&&g.length===0&&d)return;const[_,v]=u.jtdDiscriminator===void 0?(0,a.checkNullableObject)(e,c):[o.let(`valid`,false),true];o.if(v,()=>o.assign(_,true).block(()=>{x(m,`properties`,true);x(g,`optionalProperties`);if(!d)C()}));e.pass(_);function y(){const e=l.properties;const t=l.optionalProperties;if(!(e&&t))return false;for(const n in e)if(Object.prototype.hasOwnProperty.call(t,n))return true;return false}function b(e){const r=l[e];const i=r?(0,t.allSchemaProperties)(r):[];if(u.jtdDiscriminator&&i.some(e=>e===u.jtdDiscriminator))throw new Error(`JTD: discriminator tag used in ${e}`);const a=i.filter(e=>!(0,n.alwaysValidSchema)(u,r[e]));return[i,a]}function x(n,r,i){const a=o.var(`valid`);for(const i of n){o.if((0,t.propertyInData)(o,c,i,u.opts.ownProperties),()=>S(i,r,a),()=>l(i));e.ok(a)}function l(t){if(i){o.assign(a,false);e.error(false,{propError:s.Missing,missingProperty:t},{schemaPath:t})}else o.assign(a,true)}}function S(t,n,r){e.subschema({keyword:n,schemaProp:t,dataProp:t},r)}function C(){o.forIn(`key`,c,t=>{const n=w(t,p,`properties`,u.jtdDiscriminator);const i=w(t,h,`optionalProperties`);const a=n===true?i:i===true?n:(0,r.and)(n,i);o.if(a,()=>{if(u.opts.removeAdditional)o.code((0,r._)`delete ${c}[${t}]`);else{e.error(false,{propError:s.Additional,additionalProperty:t},{instancePath:t,parentSchema:true});if(!u.opts.allErrors)o.break()}})})}function w(e,i,a,s){let c;if(i.length>8){const i=(0,n.schemaRefOrVal)(u,l[a],a);c=(0,r.not)((0,t.isOwnProperty)(o,i,e));if(s!==void 0)c=(0,r.and)(c,(0,r._)`${e} !== ${s}`)}else if(i.length||s!==void 0){const t=s===void 0?i:[s].concat(i);c=(0,r.and)(...t.map(t=>(0,r._)`${e} !== ${t}`))}else c=true;return c}}exports.validateProperties=l;exports.default=c});var q=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=K();const n={keyword:`optionalProperties`,schemaType:`object`,error:t.error,code(e){if(e.parentSchema.properties)return;(0,t.validateProperties)(e)}};exports.default=n});var J=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.DiscrError=void 0;var t;(function(e){e[`Tag`]=`tag`;e[`Mapping`]=`mapping`})(t||(exports.DiscrError=t={}))});var Y=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=d();const n=R();const r=U();const i=V();const a=J();const o={message:e=>{const{schema:t,params:n}=e;return n.discrError?n.discrError===a.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in mapping`:(0,i.typeErrorMessage)(e,`object`)},params:e=>{const{schema:n,params:r}=e;return r.discrError?(0,t._)`{error: ${r.discrError}, tag: ${n}, tagValue: ${r.tag}}`:(0,i.typeErrorParams)(e,`object`)}};const s={keyword:`discriminator`,schemaType:`string`,implements:[`mapping`],error:o,code(e){(0,n.checkMetadata)(e);const{gen:i,data:o,schema:s,parentSchema:c}=e;const[l,u]=(0,r.checkNullableObject)(e,o);i.if(u);d();i.elseIf((0,t.not)(l));e.error();i.endIf();e.ok(l);function d(){const n=i.const(`tag`,(0,t._)`${o}${(0,t.getProperty)(s)}`);i.if((0,t._)`${n} === undefined`);e.error(false,{discrError:a.DiscrError.Tag,tag:n});i.elseIf((0,t._)`typeof ${n} == "string"`);f(n);i.else();e.error(false,{discrError:a.DiscrError.Tag,tag:n},{instancePath:s});i.endIf()}function f(n){i.if(false);for(const e in c.mapping){i.elseIf((0,t._)`${n} === ${e}`);i.assign(l,p(e))}i.else();e.error(false,{discrError:a.DiscrError.Mapping,tag:n},{instancePath:s,schemaPath:`mapping`,parentSchema:true});i.endIf()}function p(t){const n=i.name(`valid`);e.subschema({keyword:`mapping`,schemaProp:t,jtdDiscriminator:s},n);return n}}};exports.default=s});var X=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=f();const n=d();const r=R();const i=U();const a=V();const o={keyword:`values`,schemaType:`object`,error:(0,a.typeError)(`object`),code(e){(0,r.checkMetadata)(e);const{gen:a,data:o,schema:s,it:c}=e;const[l,u]=(0,i.checkNullableObject)(e,o);if((0,t.alwaysValidSchema)(c,s))a.if((0,n.not)((0,n.or)(u,l)),()=>e.error());else{a.if(u);a.assign(l,d());a.elseIf((0,n.not)(l));e.error();a.endIf()}e.ok(l);function d(){const r=a.name(`valid`);if(c.allErrors){const e=a.let(`valid`,true);i(()=>a.assign(e,false));return e}a.var(r,true);i(()=>a.break());return r;function i(i){a.forIn(`key`,o,o=>{e.subschema({keyword:`values`,dataProp:o,dataPropType:t.Type.Str},r);a.if((0,n.not)(r),i)})}}}};exports.default=o});var Z=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=b();const n={keyword:`union`,schemaType:`array`,trackErrors:true,code:t.validateUnion,error:{message:`must match a schema in union`}};exports.default=n});var Q=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=z();const n=H();const r=W();const i=G();const a=K();const o=q();const s=Y();const c=X();const l=Z();const u=R();const d=[`definitions`,t.default,n.default,r.default,i.default,a.default,o.default,s.default,c.default,l.default,u.default,{keyword:`additionalProperties`,schemaType:`boolean`},{keyword:`nullable`,schemaType:`boolean`}];exports.default=d});var $=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=e=>{const t={nullable:{type:`boolean`},metadata:{optionalProperties:{union:{elements:{ref:`schema`}}},additionalProperties:true}};if(e)t.definitions={values:{ref:`schema`}};return t};const n=e=>({optionalProperties:t(e)});const r=e=>({properties:{ref:{type:`string`}},optionalProperties:t(e)});const i=e=>({properties:{type:{enum:[`boolean`,`timestamp`,`string`,`float32`,`float64`,`int8`,`uint8`,`int16`,`uint16`,`int32`,`uint32`]}},optionalProperties:t(e)});const a=e=>({properties:{enum:{elements:{type:`string`}}},optionalProperties:t(e)});const o=e=>({properties:{elements:{ref:`schema`}},optionalProperties:t(e)});const s=e=>({properties:{properties:{values:{ref:`schema`}}},optionalProperties:{optionalProperties:{values:{ref:`schema`}},additionalProperties:{type:`boolean`},...t(e)}});const c=e=>({properties:{optionalProperties:{values:{ref:`schema`}}},optionalProperties:{additionalProperties:{type:`boolean`},...t(e)}});const l=e=>({properties:{discriminator:{type:`string`},mapping:{values:{metadata:{union:[s(false),c(false)]}}}},optionalProperties:t(e)});const u=e=>({properties:{values:{ref:`schema`}},optionalProperties:t(e)});const d=e=>({metadata:{union:[n,r,i,a,o,s,c,l,u].map(t=>t(e))}});const f={definitions:{schema:d(false)},...d(true)};exports.default=f});var ee=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.jtdForms=void 0;exports.jtdForms=[`elements`,`values`,`discriminator`,`properties`,`optionalProperties`,`enum`,`type`,`ref`]});var te=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;const n={"\b":`\\b`,"	":`\\t`,"\n":`\\n`,"\f":`\\f`,"\r":`\\r`,'"':`\\"`,"\\":`\\\\`};function r(e){t.lastIndex=0;return`"`+(t.test(e)?e.replace(t,e=>{const t=n[e];return typeof t===`string`?t:`\\u`+(`0000`+e.charCodeAt(0).toString(16)).slice(-4)}):e)+`"`}exports.default=r;r.code=`require("ajv/dist/runtime/quote").default`});var ne=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=ee();const n=k();const r=d();const i=O();const a=p();const o=b();const s=z();const c=f();const l=te();const u={elements:_,values:v,discriminator:x,properties:S,optionalProperties:S,enum:T,type:w,ref:D};function m(e,t){const i=n.getCompilingSchema.call(this,e);if(i)return i;const{es5:o,lines:s}=this.opts.code;const{ownProperties:c}=this.opts;const l=new r.CodeGen(this.scope,{es5:o,lines:s,ownProperties:c});const u=l.scopeName(`serialize`);const d={self:this,gen:l,schema:e.schema,schemaEnv:e,definitions:t,data:a.default.data};let f;try{this._compilations.add(e);e.serializeName=u;l.func(u,a.default.data,false,()=>{l.let(a.default.json,(0,r.str)``);h(d);l.return(a.default.json)});l.optimize(this.opts.code.optimize);const t=l.toString();f=`${l.scopeRefs(a.default.scope)}return ${t}`;const n=new Function(`${a.default.scope}`,f);const i=n(this.scope.get());this.scope.value(u,{ref:i});e.serialize=i}catch(t){if(f)this.logger.error(`Error compiling serializer, function code:`,f);delete e.serialize;delete e.serializeName;throw t}finally{this._compilations.delete(e)}return e}exports.default=m;function h(e){let n;for(const r of t.jtdForms)if(r in e.schema){n=r;break}g(e,n?u[n]:j)}function g(e,t){const{gen:n,schema:i,data:o}=e;if(!i.nullable)return t(e);n.if((0,r._)`${o} === undefined || ${o} === null`,()=>n.add(a.default.json,(0,r._)`"null"`),()=>t(e))}function _(e){const{gen:t,schema:n,data:i}=e;t.add(a.default.json,(0,r.str)`[`);const o=t.let(`first`,true);t.forOf(`el`,i,t=>{M(e,o);h({...e,schema:n.elements,data:t})});t.add(a.default.json,(0,r.str)`]`)}function v(e){const{gen:t,schema:n,data:i}=e;t.add(a.default.json,(0,r.str)`{`);const o=t.let(`first`,true);t.forIn(`key`,i,t=>y(e,t,n.values,o));t.add(a.default.json,(0,r.str)`}`)}function y(e,t,n,i){const{gen:o,data:s}=e;M(e,i);T({...e,data:t});o.add(a.default.json,(0,r.str)`:`);const c=o.const(`value`,(0,r._)`${s}${(0,r.getProperty)(t)}`);h({...e,schema:n,data:c})}function x(e){const{gen:t,schema:n,data:i}=e;const{discriminator:o}=n;t.add(a.default.json,(0,r.str)`{${JSON.stringify(o)}:`);const s=t.const(`tag`,(0,r._)`${i}${(0,r.getProperty)(o)}`);T({...e,data:s});t.if(false);for(const i in n.mapping){t.elseIf((0,r._)`${s} === ${i}`);const a=n.mapping[i];C({...e,schema:a},o)}t.endIf();t.add(a.default.json,(0,r.str)`}`)}function S(e){const{gen:t}=e;t.add(a.default.json,(0,r.str)`{`);C(e);t.add(a.default.json,(0,r.str)`}`)}function C(e,t){const{gen:n,schema:i,data:s}=e;const{properties:c,optionalProperties:l}=i;const u=g(c);const d=g(l);const f=_(u.concat(d));let p=!t;let m;for(const e of u){if(p)p=false;else n.add(a.default.json,(0,r.str)`,`);b(e,c[e],v(e))}if(p)m=n.let(`first`,true);for(const t of d){const i=v(t);n.if((0,r.and)((0,r._)`${i} !== undefined`,(0,o.isOwnProperty)(n,s,t)),()=>{M(e,m);b(t,l[t],i)})}if(i.additionalProperties)n.forIn(`key`,s,t=>n.if(x(t,f),()=>y(e,t,{},m)));function g(e){return e?Object.keys(e):[]}function _(e){if(t)e.push(t);if(new Set(e).size!==e.length)throw new Error(`JTD: properties/optionalProperties/disciminator overlap`);return e}function v(e){return n.const(`value`,(0,r._)`${s}${(0,r.getProperty)(e)}`)}function b(t,i,o){n.add(a.default.json,(0,r.str)`${JSON.stringify(t)}:`);h({...e,schema:i,data:o})}function x(e,t){return t.length?(0,r.and)(...t.map(t=>(0,r._)`${e} !== ${t}`)):true}}function w(e){const{gen:t,schema:n,data:i}=e;switch(n.type){case`boolean`:t.add(a.default.json,(0,r._)`${i} ? "true" : "false"`);break;case`string`:T(e);break;case`timestamp`:t.if((0,r._)`${i} instanceof Date`,()=>t.add(a.default.json,(0,r._)`'"' + ${i}.toISOString() + '"'`),()=>T(e));break;default:E(e)}}function T({gen:e,data:t}){e.add(a.default.json,(0,r._)`${(0,c.useFunc)(e,l.default)}(${t})`)}function E({gen:e,data:t}){e.add(a.default.json,(0,r._)`"" + ${t}`)}function D(e){const{gen:t,self:o,data:c,definitions:l,schema:u,schemaEnv:d}=e;const{ref:f}=u;const p=l[f];if(!p)throw new i.default(o.opts.uriResolver,``,f,`No definition ${f}`);if(!(0,s.hasRef)(p))return h({...e,schema:p});const{root:g}=d;const _=m.call(o,new n.SchemaEnv({schema:p,root:g}),l);t.add(a.default.json,(0,r._)`${A(t,_)}(${c})`)}function A(e,t){return t.serialize?e.scopeValue(`serialize`,{ref:t.serialize}):(0,r._)`${e.scopeValue(`wrapper`,{ref:t})}.serialize`}function j({gen:e,data:t}){e.add(a.default.json,(0,r._)`JSON.stringify(${t})`)}function M({gen:e},t){if(t)e.if(t,()=>e.assign(t,false),()=>e.add(a.default.json,(0,r.str)`,`));else e.add(a.default.json,(0,r.str)`,`)}});var re=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.parseJsonString=exports.parseJsonNumber=exports.parseJson=void 0;const t=/position\s(\d+)(?: \(line \d+ column \d+\))?$/;function n(e,r){let i;n.message=void 0;let a;if(r)e=e.slice(r);try{n.position=r+e.length;return JSON.parse(e)}catch(o){a=t.exec(o.message);if(!a){n.message=`unexpected end`;return void 0}i=+a[1];const s=e[i];e=e.slice(0,i);n.position=r+i;try{return JSON.parse(e)}catch(e){n.message=`unexpected token ${s}`;return void 0}}}exports.parseJson=n;n.message=void 0;n.position=0;n.code=`require("ajv/dist/runtime/parseJson").parseJson`;function r(e,t,n){let i=``;let a;r.message=void 0;if(e[t]===`-`){i+=`-`;t++}if(e[t]===`0`){i+=`0`;t++}else if(!o(n)){s();return void 0}if(n){r.position=t;return+i}if(e[t]===`.`){i+=`.`;t++;if(!o()){s();return void 0}}if(a=e[t],a===`e`||a===`E`){i+=`e`;t++;if(a=e[t],a===`+`||a===`-`){i+=a;t++}if(!o()){s();return void 0}}r.position=t;return+i;function o(n){let r=false;while(a=e[t],a>=`0`&&a<=`9`&&(n===void 0||n-- >0)){r=true;i+=a;t++}return r}function s(){r.position=t;r.message=t<e.length?`unexpected token ${e[t]}`:`unexpected end`}}exports.parseJsonNumber=r;r.message=void 0;r.position=0;r.code=`require("ajv/dist/runtime/parseJson").parseJsonNumber`;const i={b:`\b`,f:`\f`,n:`
`,r:`\r`,t:`	`,'"':`"`,"/":`/`,"\\":`\\`};const a=`a`.charCodeAt(0);const o=`0`.charCodeAt(0);function s(e,t){let n=``;let r;s.message=void 0;while(true){r=e[t++];if(r===`"`)break;if(r===`\\`){r=e[t];if(r in i){n+=i[r];t++}else if(r===`u`){t++;let i=4;let s=0;while(i--){s<<=4;r=e[t];if(r===void 0){c(`unexpected end`);return void 0}r=r.toLowerCase();if(r>=`a`&&r<=`f`)s+=r.charCodeAt(0)-a+10;else if(r>=`0`&&r<=`9`)s+=r.charCodeAt(0)-o;else{c(`unexpected token ${r}`);return void 0}t++}n+=String.fromCharCode(s)}else{c(`unexpected token ${r}`);return void 0}}else if(r===void 0){c(`unexpected end`);return void 0}else if(r.charCodeAt(0)>=32)n+=r;else{c(`unexpected token ${r}`);return void 0}}s.position=t;return n;function c(e){s.position=t;s.message=e}}exports.parseJsonString=s;s.message=void 0;s.position=0;s.code=`require("ajv/dist/runtime/parseJson").parseJsonString`});var ie=o(exports=>{Object.defineProperty(exports,`__esModule`,{value:true});const t=ee();const n=k();const r=d();const i=O();const a=p();const o=b();const s=z();const c=H();const l=re();const u=f();const m=B();const h={elements:C,values:w,discriminator:A,properties:j,optionalProperties:j,enum:L,type:F,ref:U};function g(e,t){const i=n.getCompilingSchema.call(this,e);if(i)return i;const{es5:o,lines:s}=this.opts.code;const{ownProperties:c}=this.opts;const l=new r.CodeGen(this.scope,{es5:o,lines:s,ownProperties:c});const u=l.scopeName(`parse`);const d={self:this,gen:l,schema:e.schema,schemaEnv:e,definitions:t,data:a.default.data,parseName:u,char:l.name(`c`)};let f;try{this._compilations.add(e);e.parseName=u;v(d);l.optimize(this.opts.code.optimize);const t=l.toString();f=`${l.scopeRefs(a.default.scope)}return ${t}`;const n=new Function(`${a.default.scope}`,f);const r=n(this.scope.get());this.scope.value(u,{ref:r});e.parse=r}catch(t){if(f)this.logger.error(`Error compiling parser, function code:`,f);delete e.parse;delete e.parseName;throw t}finally{this._compilations.delete(e)}return e}exports.default=g;const _=(0,r._)`undefined`;function v(e){const{gen:t,parseName:n,char:i}=e;t.func(n,(0,r._)`${a.default.json}, ${a.default.jsonPos}, ${a.default.jsonPart}`,false,()=>{t.let(a.default.data);t.let(i);t.assign((0,r._)`${n}.message`,_);t.assign((0,r._)`${n}.position`,_);t.assign(a.default.jsonPos,(0,r._)`${a.default.jsonPos} || 0`);t.const(a.default.jsonLen,(0,r._)`${a.default.json}.length`);y(e);X(e);t.if(a.default.jsonPart,()=>{t.assign((0,r._)`${n}.position`,a.default.jsonPos);t.return(a.default.data)});t.if((0,r._)`${a.default.jsonPos} === ${a.default.jsonLen}`,()=>t.return(a.default.data));Q(e)})}function y(e){let n;for(const r of t.jtdForms)if(r in e.schema){n=r;break}if(n)S(e,h[n]);else G(e)}const x=V(true,V(false,Q));function S(e,t){const{gen:n,schema:r,data:i}=e;if(!r.nullable)return t(e);Y(e,`null`,t,()=>n.assign(i,null))}function C(e){const{gen:t,schema:n,data:i}=e;J(e,`[`);const a=t.let(`i`,0);t.assign(i,(0,r._)`[]`);T(e,`]`,()=>{const o=t.let(`el`);y({...e,schema:n.elements,data:o});t.assign((0,r._)`${i}[${a}++]`,o)})}function w(e){const{gen:t,schema:n,data:i}=e;J(e,`{`);t.assign(i,(0,r._)`{}`);T(e,`}`,()=>D(e,n.values))}function T(e,t,n){E(e,t,n);J(e,t)}function E(e,t,n){const{gen:i}=e;i.for((0,r._)`;${a.default.jsonPos}<${a.default.jsonLen} && ${Z(1)}!==${t};`,()=>{n();Y(e,`,`,()=>i.break(),o)});function o(){Y(e,t,()=>{},Q)}}function D(e,t){const{gen:n}=e;const r=n.let(`key`);I({...e,data:r});J(e,`:`);P(e,r,t)}function A(e){const{gen:t,data:n,schema:i}=e;const{discriminator:o,mapping:s}=i;J(e,`{`);t.assign(n,(0,r._)`{}`);const c=t.const(`pos`,a.default.jsonPos);const l=t.let(`value`);const u=t.let(`tag`);E(e,`}`,()=>{const i=t.let(`key`);I({...e,data:i});J(e,`:`);t.if((0,r._)`${i} === ${o}`,()=>{I({...e,data:u});t.assign((0,r._)`${n}[${i}]`,u);t.break()},()=>G({...e,data:l}))});t.assign(a.default.jsonPos,c);t.if((0,r._)`${u} === undefined`);$(e,(0,r.str)`discriminator tag not found`);for(const n in s){t.elseIf((0,r._)`${u} === ${n}`);M({...e,schema:s[n]},o)}t.else();$(e,(0,r.str)`discriminator value not in schema`);t.endIf()}function j(e){const{gen:t,data:n}=e;J(e,`{`);t.assign(n,(0,r._)`{}`);M(e)}function M(e,t){const{gen:n,schema:i,data:a}=e;const{properties:s,optionalProperties:c,additionalProperties:l}=i;T(e,`}`,()=>{const i=n.let(`key`);I({...e,data:i});J(e,`:`);n.if(false);N(e,i,s);N(e,i,c);if(t){n.elseIf((0,r._)`${i} === ${t}`);const a=n.let(`tag`);I({...e,data:a})}n.else();if(l)G({...e,data:(0,r._)`${a}[${i}]`});else $(e,(0,r.str)`property ${i} not allowed`);n.endIf()});if(s){const t=(0,o.hasPropFunc)(n);const i=(0,r.and)(...Object.keys(s).map(e=>(0,r._)`${t}.call(${a}, ${e})`));n.if((0,r.not)(i),()=>$(e,(0,r.str)`missing required properties`))}}function N(e,t,n={}){const{gen:i}=e;for(const a in n){i.elseIf((0,r._)`${t} === ${a}`);P(e,t,n[a])}}function P(e,t,n){y({...e,schema:n,data:(0,r._)`${e.data}[${t}]`})}function F(e){const{gen:t,schema:n,data:i,self:a}=e;switch(n.type){case`boolean`:x(e);break;case`string`:I(e);break;case`timestamp`:{I(e);const n=(0,u.useFunc)(t,m.default);const{allowDate:o,parseDate:s}=a.opts;const c=o?(0,r._)`!${n}(${i}, true)`:(0,r._)`!${n}(${i})`;const l=s?(0,r.or)(c,(0,r._)`(${i} = new Date(${i}), false)`,(0,r._)`isNaN(${i}.valueOf())`):c;t.if(l,()=>$(e,(0,r.str)`invalid timestamp`));break}case`float32`:case`float64`:R(e);break;default:{const o=n.type;if(!a.opts.int32range&&(o===`int32`||o===`uint32`)){R(e,16);if(o===`uint32`)t.if((0,r._)`${i} < 0`,()=>$(e,(0,r.str)`integer out of range`))}else{const[n,a,s]=c.intRange[o];R(e,s);t.if((0,r._)`${i} < ${n} || ${i} > ${a}`,()=>$(e,(0,r.str)`integer out of range`))}}}}function I(e){J(e,`"`);K(e,l.parseJsonString)}function L(e){const{gen:t,data:n,schema:i}=e;const o=i.enum;J(e,`"`);t.if(false);for(const e of o){const i=JSON.stringify(e).slice(1);t.elseIf((0,r._)`${Z(i.length)} === ${i}`);t.assign(n,(0,r.str)`${e}`);t.add(a.default.jsonPos,i.length)}t.else();Q(e);t.endIf()}function R(e,t){const{gen:n}=e;X(e);n.if((0,r._)`"-0123456789".indexOf(${Z(1)}) < 0`,()=>Q(e),()=>K(e,l.parseJsonNumber,t))}function V(e,t){return n=>{const{gen:r,data:i}=n;Y(n,`${e}`,()=>t(n),()=>r.assign(i,e))}}function U(e){const{gen:t,self:r,definitions:a,schema:o,schemaEnv:c}=e;const{ref:l}=o;const u=a[l];if(!u)throw new i.default(r.opts.uriResolver,``,l,`No definition ${l}`);if(!(0,s.hasRef)(u))return y({...e,schema:u});const{root:d}=c;const f=g.call(r,new n.SchemaEnv({schema:u,root:d}),a);q(e,W(t,f),true)}function W(e,t){return t.parse?e.scopeValue(`parse`,{ref:t.parse}):(0,r._)`${e.scopeValue(`wrapper`,{ref:t})}.parse`}function G(e){K(e,l.parseJson)}function K(e,t,n){q(e,(0,u.useFunc)(e.gen,t),n)}function q(e,t,n){const{gen:i,data:o}=e;i.assign(o,(0,r._)`${t}(${a.default.json}, ${a.default.jsonPos}${n?(0,r._)`, ${n}`:r.nil})`);i.assign(a.default.jsonPos,(0,r._)`${t}.position`);i.if((0,r._)`${o} === undefined`,()=>$(e,(0,r._)`${t}.message`))}function J(e,t){Y(e,t,Q)}function Y(e,t,n,i){const{gen:o}=e;const s=t.length;X(e);o.if((0,r._)`${Z(s)} === ${t}`,()=>{o.add(a.default.jsonPos,s);i===null||i===void 0||i(e)},()=>n(e))}function X({gen:e,char:t}){e.code((0,r._)`while((${t}=${a.default.json}[${a.default.jsonPos}],${t}===" "||${t}==="\\n"||${t}==="\\r"||${t}==="\\t"))${a.default.jsonPos}++;`)}function Z(e){return e===1?(0,r._)`${a.default.json}[${a.default.jsonPos}]`:(0,r._)`${a.default.json}.slice(${a.default.jsonPos}, ${a.default.jsonPos}+${e})`}function Q(e){$(e,(0,r._)`"unexpected token " + ${a.default.json}[${a.default.jsonPos}]`)}function $({gen:e,parseName:t},n){e.assign((0,r._)`${t}.message`,n);e.assign((0,r._)`${t}.position`,a.default.jsonPos);e.return(_)}});var ae=o((exports,t)=>{Object.defineProperty(exports,`__esModule`,{value:true});exports.MissingRefError=exports.ValidationError=exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=exports.Ajv=void 0;const n=I();const r=Q();const i=$();const a=ne();const o=ie();const s=`JTD-meta-schema`;var c=class extends n.default{constructor(e={}){super({...e,jtd:true})}_addVocabularies(){super._addVocabularies();this.addVocabulary(r.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema();if(!this.opts.meta)return;this.addMetaSchema(i.default,s,false)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(s)?s:void 0)}compileSerializer(e){const t=this._addSchema(e);return t.serialize||this._compileSerializer(t)}compileParser(e){const t=this._addSchema(e);return t.parse||this._compileParser(t)}_compileSerializer(e){a.default.call(this,e,e.schema.definitions||{});if(!e.serialize)throw new Error(`ajv implementation error`);return e.serialize}_compileParser(e){o.default.call(this,e,e.schema.definitions||{});if(!e.parse)throw new Error(`ajv implementation error`);return e.parse}};exports.Ajv=c;t.exports=exports=c;t.exports.Ajv=c;Object.defineProperty(exports,`__esModule`,{value:true});exports.default=c;var l=E();Object.defineProperty(exports,`KeywordCxt`,{enumerable:true,get:function(){return l.KeywordCxt}});var u=d();Object.defineProperty(exports,`_`,{enumerable:true,get:function(){return u._}});Object.defineProperty(exports,`str`,{enumerable:true,get:function(){return u.str}});Object.defineProperty(exports,`stringify`,{enumerable:true,get:function(){return u.stringify}});Object.defineProperty(exports,`nil`,{enumerable:true,get:function(){return u.nil}});Object.defineProperty(exports,`Name`,{enumerable:true,get:function(){return u.Name}});Object.defineProperty(exports,`CodeGen`,{enumerable:true,get:function(){return u.CodeGen}});var f=D();Object.defineProperty(exports,`ValidationError`,{enumerable:true,get:function(){return f.default}});var p=O();Object.defineProperty(exports,`MissingRefError`,{enumerable:true,get:function(){return p.default}})});var oe=c(ae(),1);var se=new oe.default().compile({definitions:{uuid:{type:`string`},user_role:{enum:[`admin`,`manager`,`developer`,`viewer`]},task_status:{enum:[`todo`,`in_progress`,`review`,`done`]},comment:{properties:{id:{type:`string`},author_id:{type:`string`},content:{type:`string`},created_at:{type:`string`}},optionalProperties:{updated_at:{type:`string`}}},task:{properties:{id:{type:`string`},title:{type:`string`},status:{ref:`task_status`},assignees:{elements:{ref:`uuid`}},comments:{elements:{ref:`comment`}},created_at:{type:`string`}},optionalProperties:{description:{type:`string`},due_date:{type:`string`}}},user:{properties:{id:{ref:`uuid`},name:{type:`string`},email:{type:`string`},role:{ref:`user_role`},is_active:{type:`boolean`}},optionalProperties:{last_login:{type:`string`}}},project:{properties:{id:{ref:`uuid`},name:{type:`string`},owner_id:{ref:`uuid`},members:{elements:{ref:`user`}},tasks:{elements:{ref:`task`}},created_at:{type:`string`}},optionalProperties:{description:{type:`string`},tags:{elements:{type:`string`}}}}},ref:`project`});export{se as default};